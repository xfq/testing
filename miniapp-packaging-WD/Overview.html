<!DOCTYPE html><html lang="en"><head>
<meta charset="utf-8">
<meta name="generator" content="ReSpec 28.0.3">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<style>
span.example-title{text-transform:none}
:is(aside,div).example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
div.illegal-example{color:red}
div.illegal-example p{color:#000}
:is(aside,div).example{border-left-width:.5em;border-left-style:solid;border-color:#e0cb52;background:#fcfaee}
aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
.example pre{background-color:rgba(0,0,0,.03)}
</style>
<style>
.issue-label{text-transform:initial}
.warning>p:first-child{margin-top:0}
.warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
span.warning{padding:.1em .5em .15em}
.issue.closed span.issue-number{text-decoration:line-through}
.warning{border-color:#f11;border-width:.2em;border-style:solid;background:#fbe9e9}
.warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
li.task-list-item{list-style:none}
input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
.issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
</style>
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font:small Helvetica Neue,sans-serif,Droid Sans Fallback;background:#fff;color:#000;box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;margin-top:.25em}
.dfn-panel ul a[href]{color:#333}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
    
    
<title>MiniApp Packaging</title>
    
    

<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
.hljs{background:0 0!important}
:is(h1,h2,h3,h4,h5,h6,a) abbr{border:none}
dfn{font-weight:700}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
code{color:#c63501}
th code{color:inherit}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
.toc a,.tof a{text-decoration:none}
a .figno,a .secno{color:#000}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
table.simple{border-spacing:0;border-collapse:collapse;border-bottom:3px solid #005a9c}
.simple th{background:#005a9c;color:#fff;padding:3px 5px;text-align:left}
.simple th a{color:#fff;padding:3px 5px;text-align:left}
.simple th[scope=row]{background:inherit;color:inherit;border-top:1px solid #ddd}
.simple td{padding:3px 10px;border-top:1px solid #ddd}
.simple tr:nth-child(even){background:#f0f6ff}
.section dd>p:first-child{margin-top:0}
.section dd>p:last-child{margin-bottom:0}
.section dd{margin-bottom:1em}
.section dl.attrs dd,.section dl.eldef dd{margin-bottom:0}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
a[href].self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
h2,h3,h4,h5,h6{position:relative}
aside.example .marker>a.self-link{color:inherit}
:is(h2,h3,h4,h5,h6)>a.self-link{border:none;color:inherit;font-size:83%;height:2em;left:-1.6em;opacity:.5;position:absolute;text-align:center;text-decoration:none;top:0;transition:opacity .2s;width:2em}
:is(h2,h3,h4,h5,h6)>a.self-link::before{content:"§";display:block}
@media (max-width:767px){
dd{margin-left:0}
:is(h2,h3,h4,h5,h6)>a.self-link{left:auto;top:auto}
}
@media print{
.removeOnSave{display:none}
}
</style>
<meta name="description" content="This specification defines semantics and conformance requirements for a MiniApp package, and the structure of the single file container that holds the resources of a MiniApp, including a manifest file, static page templates, stylesheets, JavaScript documents, media files and other resources. Instances of the MiniApp package are used for MiniApp distribution and execution on runtime environments (MiniApp user agent).">
<link rel="canonical" href="https://www.w3.org/TR/miniapp-packaging/">
<style>
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}
.hljs-comment,.hljs-quote{color:#717277;font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;font-weight:700}
.hljs-literal{color:#0b76c5}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#000}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#000;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
</style>
<script id="initialUserConfig" type="application/json">{
  "specStatus": "FPWD",
  "copyrightStart": "2021",
  "edDraftURI": "https://w3c.github.io/miniapp-packaging/",
  "shortName": "miniapp-packaging",
  "publishDate": "2021-11-16",
  "editors": [
    {
      "name": "Martin Alvarez-Espinar",
      "companyURL": "https://www.huawei.com",
      "company": "Huawei",
      "w3cid": 125049
    },
    {
      "name": "Qing An",
      "companyURL": "https://www.alibabagroup.com/en/global/home",
      "company": "Alibaba",
      "w3cid": 76701
    },
    {
      "name": "Tengyuan Zhang",
      "companyURL": "https://www.baidu.com/",
      "company": "Baidu, Inc",
      "w3cid": 118561
    },
    {
      "name": "Yongjing Zhang",
      "companyURL": "https://www.huawei.com/",
      "company": "Huawei",
      "w3cid": 75048
    },
    {
      "name": "Dan Zhou",
      "companyURL": "https://www.baidu.com/",
      "company": "Baidu, Inc",
      "w3cid": 118521
    }
  ],
  "formerEditors": [
    {
      "name": "Shouren Lan",
      "companyURL": "https://www.huawei.com/",
      "company": "Huawei"
    },
    {
      "name": "Zhiqiang Yu",
      "companyURL": "https://www.huawei.com/",
      "company": "Huawei"
    },
    {
      "name": "Qian Liu",
      "companyURL": "https://www.baidu.com/",
      "company": "Baidu, Inc"
    },
    {
      "name": "Shuo Wang",
      "companyURL": "https://www.baidu.com/",
      "company": "Baidu, Inc"
    }
  ],
  "group": "wg/miniapps",
  "github": {
    "repoURL": "https://github.com/w3c/miniapp-packaging",
    "branch": "main"
  },
  "localBiblio": {
    "APK-SIGNATURE-V2": {
      "title": "APK Signature Scheme v2",
      "href": "https://source.android.com/security/apksigning/v2",
      "id": "apk-signature-v2"
    },
    "CSS-SNAPSHOT": {
      "title": "CSS Snapshot",
      "href": "https://www.w3.org/TR/CSS/",
      "id": "css-snapshot"
    },
    "MINIAPP-ADDRESSING": {
      "title": "MiniApp Addressing",
      "href": "https://w3c.github.io/miniapp-addressing/"
    }
  },
  "a11y": true,
  "publishISODate": "2021-11-16T00:00:00.000Z",
  "generatedSubtitle": "First Public Working Draft 16 November 2021"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/W3C-WD"></head>

<body data-cite="MINIAPP-MANIFEST INFRA URL HTML" data-new-gr-c-s-check-loaded="14.1038.0" data-gr-ext-installed="" class="h-entry"><div class="head">
    <a class="logo" href="https://www.w3.org/"><img crossorigin="" alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
  </a> <h1 id="title" class="title">MiniApp Packaging</h1>
    
    <p id="w3c-state"><a href="https://www.w3.org/standards/types#FPWD">W3C First Public Working Draft</a> <time class="dt-published" datetime="2021-11-16">16 November 2021</time></p>
    <details open="">
      <summary>More details about this document</summary>
      <dl>
        <dt>This version:</dt><dd>
                <a class="u-url" href="https://www.w3.org/TR/2021/WD-miniapp-packaging-20211116/">https://www.w3.org/TR/2021/WD-miniapp-packaging-20211116/</a>
              </dd><dt>Latest published version:</dt><dd>
                <a href="https://www.w3.org/TR/miniapp-packaging/">https://www.w3.org/TR/miniapp-packaging/</a>
              </dd>
        <dt>Latest editor's draft:</dt><dd><a href="https://w3c.github.io/miniapp-packaging/">https://w3c.github.io/miniapp-packaging/</a></dd>
        <dt>History:</dt><dd>
      <a href="https://www.w3.org/standards/history/miniapp-packaging">https://www.w3.org/standards/history/miniapp-packaging</a>
    </dd><dd>
        <a href="https://github.com/w3c/miniapp-packaging/commits/main">Commit history</a>
      </dd>
        
        
        
        
        
        <dt>Editors:</dt>
        <dd class="editor p-author h-card vcard" data-editor-id="125049">
    <span class="p-name fn">Martin Alvarez-Espinar</span> (<a class="p-org org h-org" href="https://www.huawei.com">Huawei</a>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="76701">
    <span class="p-name fn">Qing An</span> (<a class="p-org org h-org" href="https://www.alibabagroup.com/en/global/home">Alibaba</a>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="118561">
    <span class="p-name fn">Tengyuan Zhang</span> (<a class="p-org org h-org" href="https://www.baidu.com/">Baidu, Inc</a>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="75048">
    <span class="p-name fn">Yongjing Zhang</span> (<a class="p-org org h-org" href="https://www.huawei.com/">Huawei</a>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="118521">
    <span class="p-name fn">Dan Zhou</span> (<a class="p-org org h-org" href="https://www.baidu.com/">Baidu, Inc</a>)
  </dd>
        <dt>
                Former editors:
              </dt><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Shouren Lan</span> (<a class="p-org org h-org" href="https://www.huawei.com/">Huawei</a>)
  </dd><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Zhiqiang Yu</span> (<a class="p-org org h-org" href="https://www.huawei.com/">Huawei</a>)
  </dd><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Qian Liu</span> (<a class="p-org org h-org" href="https://www.baidu.com/">Baidu, Inc</a>)
  </dd><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Shuo Wang</span> (<a class="p-org org h-org" href="https://www.baidu.com/">Baidu, Inc</a>)
  </dd>
        
        <dt>Feedback:</dt><dd>
        <a href="https://github.com/w3c/miniapp-packaging/">GitHub w3c/miniapp-packaging</a>
        (<a href="https://github.com/w3c/miniapp-packaging/pulls/">pull requests</a>,
        <a href="https://github.com/w3c/miniapp-packaging/issues/new/choose">new issue</a>,
        <a href="https://github.com/w3c/miniapp-packaging/issues/">open issues</a>)
      </dd>
        
        
      </dl>
    </details>
    
    
    <p class="copyright">
    <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
    ©
    2021
    
    <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
    <a href="https://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="https://www.keio.ac.jp/">Keio</a>,
    <a href="https://ev.buaa.edu.cn/">Beihang</a>). W3C
    <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
    <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and
    <a rel="license" href="https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document" title="W3C Software and Document Notice and License">permissive document license</a> rules apply.
  </p>
    <hr title="Separator for header">
  </div>
    <section id="abstract" class="introductory"><h2>Abstract</h2>
        <p>This specification defines semantics and conformance requirements for a <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-1">MiniApp package</a>, and the structure of the single file container that holds the resources of a MiniApp, including a manifest file, static page templates, stylesheets, JavaScript documents, media files and other resources. Instances of the <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-2">MiniApp package</a> are used for MiniApp distribution and execution on runtime environments (<a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-1">MiniApp user agent</a>).</p>
    </section>
    <section id="sotd" class="introductory"><h2>Status of This Document</h2><p><em>This section describes the status of this
      document at the time of its publication. A list of current <abbr title="World Wide Web Consortium">W3C</abbr>
      publications and the latest revision of this technical report can be found
      in the <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at
      https://www.w3.org/TR/.</em></p>
    <p>
    This document was published by the <a href="https://www.w3.org/groups/wg/miniapps">MiniApps Working Group</a> as
    a First Public Working Draft using the
        <a href="https://www.w3.org/2021/Process-20211102/#recs-and-notes">Recommendation track</a>. 
  </p><p>Publication as a First Public Working Draft does not
  imply endorsement by <abbr title="World Wide Web Consortium">W3C</abbr> and its Members. </p><p>
    This is a draft document and may be updated, replaced or obsoleted by other
    documents at any time. It is inappropriate to cite this document as other
    than work in progress.
    
  </p><p>
    
        This document was produced by a group
        operating under the
        <a href="https://www.w3.org/Consortium/Patent-Policy/"><abbr title="World Wide Web Consortium">W3C</abbr> Patent
          Policy</a>.
      
    
                <abbr title="World Wide Web Consortium">W3C</abbr> maintains a
                <a rel="disclosure" href="https://www.w3.org/groups/wg/miniapps/ipr">public list of any patent disclosures</a>
          made in connection with the deliverables of
          the group; that page also includes
          instructions for disclosing a patent. An individual who has actual
          knowledge of a patent which the individual believes contains
          <a href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">Essential Claim(s)</a>
          must disclose the information in accordance with
          <a href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">section 6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
        
  </p><p>
                  This document is governed by the
                  <a id="w3c_process_revision" href="https://www.w3.org/2021/Process-20211102/">2 November 2021 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>.
                </p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#sec-introduction"><bdi class="secno">1. </bdi>Introduction</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#overview"><bdi class="secno">1.1 </bdi>Overview</a></li><li class="tocline"><a class="tocxref" href="#sec-terminology"><bdi class="secno">1.2 </bdi>Terminology</a></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">1.3 </bdi>Conformance</a></li></ol></li><li class="tocline"><a class="tocxref" href="#sec-conformance"><bdi class="secno">2. </bdi>Package Conformance</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#sec-filestructure"><bdi class="secno">2.1 </bdi>Directory and File System Structure</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#root-directory"><bdi class="secno">2.1.1 </bdi>Root Directory</a></li><li class="tocline"><a class="tocxref" href="#sec-pages-directory"><bdi class="secno">2.1.2 </bdi><code>pages</code> Directory</a></li><li class="tocline"><a class="tocxref" href="#common-directory"><bdi class="secno">2.1.3 </bdi><code>common</code> Directory</a></li><li class="tocline"><a class="tocxref" href="#i18n-directory"><bdi class="secno">2.1.4 </bdi><code><abbr title="internationalization">i18n</abbr></code> Directory</a></li><li class="tocline"><a class="tocxref" href="#file-names"><bdi class="secno">2.1.5 </bdi>File Names</a></li></ol></li><li class="tocline"><a class="tocxref" href="#sec-miniapp-resources"><bdi class="secno">2.2 </bdi>MiniApp Resources</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#sec-miniapp-resources-html"><bdi class="secno">2.2.1 </bdi>HTML Resources</a></li><li class="tocline"><a class="tocxref" href="#sec-miniapp-resources-css"><bdi class="secno">2.2.2 </bdi>CSS Resources</a></li><li class="tocline"><a class="tocxref" href="#sec-miniapp-resources-js"><bdi class="secno">2.2.3 </bdi>Scripting Resources</a></li><li class="tocline"><a class="tocxref" href="#sec-miniapp-resources-i18n"><bdi class="secno">2.2.4 </bdi>Localization Resources</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#sec-miniapp-zip-container"><bdi class="secno">3. </bdi>MiniApp ZIP Container</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#sec-miniapp-zip-container-intro"><bdi class="secno">3.1 </bdi>Introduction</a></li><li class="tocline"><a class="tocxref" href="#sec-miniapp-zip-file-requirements"><bdi class="secno">3.2 </bdi>ZIP File Requirements</a></li><li class="tocline"><a class="tocxref" href="#sec-miniapp-digital-signature-requirements"><bdi class="secno">3.3 </bdi>Digital Signature Requirements</a></li></ol></li><li class="tocline"><a class="tocxref" href="#sec-miniapp-i18n"><bdi class="secno">4. </bdi>Internationalization</a></li><li class="tocline"><a class="tocxref" href="#sec-miniapp-processing"><bdi class="secno">5. </bdi>MiniApp Package Processing</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#sec-miniapp-processing-retrieval"><bdi class="secno">5.1 </bdi>MiniApp ZIP Container Retrieval</a></li><li class="tocline"><a class="tocxref" href="#sec-miniapp-processing-verify"><bdi class="secno">5.2 </bdi>MiniApp ZIP Container Verification</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#sec-miniapp-digital-signatures-processing"><bdi class="secno">5.2.1 </bdi>Digital Signatures Processing</a></li></ol></li><li class="tocline"><a class="tocxref" href="#sec-miniapp-processing-manifest"><bdi class="secno">5.3 </bdi>MiniApp Manifest Processing</a></li><li class="tocline"><a class="tocxref" href="#sec-miniapp-platform-runtime-preparation"><bdi class="secno">5.4 </bdi>Platform Runtime Preparation</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#sec-miniapp-platform-compatibility-verification"><bdi class="secno">5.4.1 </bdi>Platform Compatibility Verification</a></li><li class="tocline"><a class="tocxref" href="#sec-miniapp-platform-start-page-identification"><bdi class="secno">5.4.2 </bdi>Start Page Identification</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#sec-miniapp-processing-platform-start-page-uri"><bdi class="secno">5.4.2.1 </bdi>Extraction of Start Page From URI</a></li><li class="tocline"><a class="tocxref" href="#sec-miniapp-processing-platform-start-page-manifest"><bdi class="secno">5.4.2.2 </bdi>Extraction of Start Page From Manifest</a></li></ol></li><li class="tocline"><a class="tocxref" href="#sec-miniapp-processing-locale"><bdi class="secno">5.4.3 </bdi>Extraction of Locale</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#sec-security-privacy"><bdi class="secno">6. </bdi>Security and Privacy Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#package-integrity-and-trustworthiness"><bdi class="secno">6.1 </bdi>Package Integrity and Trustworthiness</a></li><li class="tocline"><a class="tocxref" href="#content-confidentiality"><bdi class="secno">6.2 </bdi>Content Confidentiality</a></li></ol></li><li class="tocline"><a class="tocxref" href="#sec-acknowledgments"><bdi class="secno">A. </bdi>Acknowledgments</a></li><li class="tocline"><a class="tocxref" href="#sec-signature-schemes"><bdi class="secno">B. </bdi>Signature Schemes</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#sec-signature-rpk"><bdi class="secno">B.1 </bdi>RPK Signature Scheme</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#sec-signing-block-signature"><bdi class="secno">B.1.1 </bdi>Signatures</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#developer-signature"><bdi class="secno">B.1.1.1 </bdi>Developer Signature</a></li><li class="tocline"><a class="tocxref" href="#distributor-signature"><bdi class="secno">B.1.1.2 </bdi>Distributor Signature</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#sec-signature-pkcs7"><bdi class="secno">B.2 </bdi>PKCS#7 Signature Scheme</a></li></ol></li><li class="tocline"><a class="tocxref" href="#sec-media-type-registration"><bdi class="secno">C. </bdi>Media Type Registration</a></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">D. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">D.1 </bdi>Normative references</a></li><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">D.2 </bdi>Informative references</a></li></ol></li></ol></nav>
    <section id="sec-introduction">
        <h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction<a class="self-link" aria-label="§" href="#sec-introduction"></a></h2>
        <section id="overview">
            <h3 id="x1-1-overview"><bdi class="secno">1.1 </bdi>Overview<a class="self-link" aria-label="§" href="#overview"></a></h3>
            <p><a data-link-type="dfn" href="#dfn-miniapp" class="internalDFN" id="ref-for-dfn-miniapp-1">MiniApp</a> is a concept of light software application, that can be distributed through any digital means, and accessed through the Web. MiniApps are defined by a concrete file structure and all their resources are packed within a single file that represents the whole <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-3">MiniApp package</a> that can be processed and executed by <a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-2">MiniApp user agents</a>.</p>
            <p>A <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-4">MiniApp package</a> contains a directory structure that holds the specific resources of the MiniApp that defines the rendering, operation, and interaction with the end-users — including static page templates, stylesheets, JavaScript documents, media files, and other resources — and the manifest. The <a href="https://www.w3.org/TR/miniapp-manifest/#dfn-miniapp-manifest-s" data-link-type="dfn">MiniApp manifest</a>, located in the central directory of the package, describes the MiniApp, including information about page routing, styles, and other operational and rendering details of the MiniApp, as well as descriptive information for humans.</p>
            <p>As defined in <a href="#sec-security-privacy">Security and Privacy Considerations</a>, MiniApps <em class="rfc2119">MAY</em> support <a data-link-type="dfn" href="#dfn-signature" class="internalDFN" id="ref-for-dfn-signature-1">digital signature</a> verification to guarantee the integrity of the package and contents during the delivery of the package.</p>
            <p>The MiniApp runtime environment (<a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-3">MiniApp user agent</a>) identifies MiniApp package files through the standard <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-5">MiniApp package</a> format and the specific MIME media type, defined in this document. After retrieving the <a data-link-type="dfn" href="#dfn-container" class="internalDFN" id="ref-for-dfn-container-1">MiniApp ZIP container</a>, the <a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-4">MiniApp user agent</a> loads the static page templates, stylesheets, JavaScript files, and other resources into the cache, following a <a href="#sec-miniapp-processing">dereference and processing algorithm</a>. These <a data-link-type="dfn" href="#dfn-resource" class="internalDFN" id="ref-for-dfn-resource-1">MiniApp resources</a> will remain available in the cache until the next update, avoiding unnecessary network fetches.</p>
            <p>In terms of launch mode, a MiniApp can be launched normally when offline. The <a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-5">MiniApp user agent</a> locates the specified <a data-link-type="dfn" href="#dfn-start-page" class="internalDFN" id="ref-for-dfn-start-page-1">start page</a> from the package cache path and launches the MiniApp according to the description set out in the <a href="https://www.w3.org/TR/miniapp-manifest/#dfn-miniapp-manifest-s" data-link-type="dfn">MiniApp manifest</a> file.</p>
        </section>
        <section id="sec-terminology">
            <h3 id="x1-2-terminology"><bdi class="secno">1.2 </bdi>Terminology<a class="self-link" aria-label="§" href="#sec-terminology"></a></h3>
            <p>The following terms are specific to MiniApps.</p>
            <dl class="termlist">
                <dt><dfn id="dfn-signature" data-lt="signatures|signature|digital signature|digital signatures|Digital signature" data-dfn-type="dfn" tabindex="0" aria-haspopup="dialog">Digital signature</dfn></dt>
                <dd>A cryptographic mechanism and hashing techniques to prove the authenticity of <a data-link-type="dfn" href="#dfn-resource" class="internalDFN" id="ref-for-dfn-resource-2">resources</a>. Digital signatures can demonstrate the origin, time, identity, and status of <a data-link-type="dfn" href="#dfn-resource" class="internalDFN" id="ref-for-dfn-resource-3">resources</a> and of the <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-6">MiniApp package</a>.</dd>
                <dt><dfn id="dfn-filename" data-lt="file name|file names|File name" data-dfn-type="dfn" tabindex="0" aria-haspopup="dialog">File name</dfn></dt>
                <dd>The name of any file within a <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-7">MiniApp package</a>, either a directory or a file within a directory.</dd>
                <dt><dfn data-export="" id="dfn-miniapp" data-lt="MiniApps|MiniApp" data-dfn-type="dfn" tabindex="0" aria-haspopup="dialog">MiniApp</dfn></dt>
                <dd>A light software application, that can be distributed through any digital means, and accessed through the Web. MiniApps are defined by a concrete file structure, distributed within a single file <a data-link-type="dfn" href="#dfn-container" class="internalDFN" id="ref-for-dfn-container-2">MiniApp ZIP container</a> that represents the whole <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-8">MiniApp package</a> that can be processed and executed by <a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-6">MiniApp user agents</a>.</dd>
                <dt><dfn id="dfn-package" data-lt="MiniApp package|MiniApp packages|package" data-dfn-type="dfn" data-plurals="miniapp packages" tabindex="0" aria-haspopup="dialog">MiniApp package</dfn></dt>
                <dd>A logical document entity composed of a set of <a data-link-type="dfn" href="#dfn-resource" class="internalDFN" id="ref-for-dfn-resource-4">resources</a> packaged in a <a data-link-type="dfn" href="#dfn-container" class="internalDFN" id="ref-for-dfn-container-3">MiniApp ZIP container</a>.</dd>
                <dt><dfn id="dfn-resource" data-lt="resources|resource|MiniApp resources|MiniApp resource" data-dfn-type="dfn" data-plurals="miniapp resources" tabindex="0" aria-haspopup="dialog">MiniApp resource</dfn></dt>
                <dd>A logical document that is part of the view or the logic of a MiniApp. Resources are included physically in <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-9">MiniApp packages</a>.</dd>
                <dt><dfn id="dfn-page" data-lt="pages|page|MiniApp pages|MiniApp page" data-dfn-type="dfn" data-plurals="miniapp pages" tabindex="0" aria-haspopup="dialog">MiniApp page</dfn></dt>
                <dd>A collection of information that is displayed in a <a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-7">MiniApp user agent</a>, under the scope of a specific MiniApp. </dd>
                <dt><dfn id="dfn-useragent" data-lt="user agents|user agent|MiniApp user agents|MiniApp user agent" data-dfn-type="dfn" data-plurals="miniapp user agents" tabindex="0" aria-haspopup="dialog">MiniApp user agent</dfn></dt>
                <dd>A software application that gets, process and renders <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-10">MiniApp packages</a>, enabling execution and end-user interaction with MiniApps.</dd>
                <dt><dfn id="dfn-container" data-lt="ZIP container|ZIP containers|MiniApp ZIP containers|MiniApp ZIP container" data-dfn-type="dfn" data-plurals="miniapp zip containers" tabindex="0" aria-haspopup="dialog">MiniApp ZIP container</dfn></dt>
                <dd>The ZIP-based packaging and distribution format for MiniApps, as defined in <a href="#sec-miniapp-zip-container">MiniApp ZIP container</a> section.</dd>
                <dt><dfn data-export="" id="dfn-widget" data-lt="widget|widgets|MiniApp widgets|MiniApp widget" data-dfn-type="dfn" tabindex="0" aria-haspopup="dialog">MiniApp widget</dfn></dt>
                <dd>A special type of <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-1">MiniApp page</a> that is displayed standalone in host environments such as assistants and device search pages to connect MiniApp services in specific scenarios.</dd>
                <dt><dfn id="dfn-start-page" data-lt="MiniApp start pages|start page|start pages|MiniApp start page" data-dfn-type="dfn" tabindex="0" aria-haspopup="dialog">MiniApp start page</dfn></dt>
                <dd>The entry point of a MiniApp. The resource that is loaded and rendered by the <a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-8">MiniApp user agent</a> at the launch of the application.</dd>  
            </dl>
        </section>
        <section id="conformance"><h3 id="x1-3-conformance"><bdi class="secno">1.3 </bdi>Conformance<a class="self-link" aria-label="§" href="#conformance"></a></h3><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p><p>
        The key words <em class="rfc2119">MAY</em>, <em class="rfc2119">MUST</em>, <em class="rfc2119">MUST NOT</em>, and <em class="rfc2119">SHOULD</em> in this document
        are to be interpreted as described in
        <a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
        when, and only when, they appear in all capitals, as shown here.
      </p>
            The MiniApp Packaging specification depends on the Infra Standard [<cite><a class="bibref" data-link-type="biblio" href="#bib-infra" title="Infra Standard">INFRA</a></cite>] to describe algorithms.
        </section>
    </section>

    <section id="sec-conformance">
        <h2 id="x2-package-conformance"><bdi class="secno">2. </bdi>Package Conformance<a class="self-link" aria-label="§" href="#sec-conformance"></a></h2>
        <p>A conformant <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-11">MiniApp package</a> <em class="rfc2119">MUST</em> meet the following criteria:</p>
        <ul class="conformance-list">
            <li>The file system of a package <em class="rfc2119">MUST</em> have a file structure based on a <a data-link-type="dfn" href="#dfn-root-directory" class="internalDFN" id="ref-for-dfn-root-directory-1">root directory</a> and the <a href="#sec-pages-directory"><code>pages</code> subdirectory</a>.</li>
            <li>The <a data-link-type="dfn" href="#dfn-root-directory" class="internalDFN" id="ref-for-dfn-root-directory-2">root directory</a> <em class="rfc2119">MAY</em> include a subdirectory <code>common</code> to store resources available at application level.</li>
            <li>The <a data-link-type="dfn" href="#dfn-root-directory" class="internalDFN" id="ref-for-dfn-root-directory-3">root directory</a> <em class="rfc2119">SHOULD</em> include a subdirectory <code><abbr title="internationalization">i18n</abbr></code> to store <a data-link-type="dfn" href="#dfn-localization-resources" class="internalDFN" id="ref-for-dfn-localization-resources-1">localization resources</a> for internationalization purposes.</li>
            <li>The <a data-link-type="dfn" href="#dfn-root-directory" class="internalDFN" id="ref-for-dfn-root-directory-4">root directory</a> <em class="rfc2119">MUST</em> contain one configuration file, named <code>manifest.json</code>, to describe and configure the runtime environment as defined in the <a href="https://www.w3.org/TR/miniapp-manifest/#dfn-miniapp-manifest-s" data-link-type="dfn">MiniApp manifest</a> specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-miniapp-manifest" title="MiniApp Manifest">MINIAPP-MANIFEST</a></cite>].</li>
            <li>The <a data-link-type="dfn" href="#dfn-root-directory" class="internalDFN" id="ref-for-dfn-root-directory-5">root directory</a> <em class="rfc2119">MUST</em> contain one script document, named <code>app.js</code>, with the basic control logic of the MiniApp. </li>
            <li>The <a data-link-type="dfn" href="#dfn-root-directory" class="internalDFN" id="ref-for-dfn-root-directory-6">root directory</a> <em class="rfc2119">MUST</em> contain one stylesheet, named <code>app.css</code>, following a syntax, structure and format as defined in the <a href="#sec-miniapp-resources-css">CSS Resources</a> section.</li>
            <li>The whole <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-12">MiniApp package</a> <em class="rfc2119">MUST</em> be wrapped as a [<cite><a class="bibref" data-link-type="biblio" href="#bib-zip" title=".ZIP File Format Specification">ZIP</a></cite>] file, according to the requirements of <a data-link-type="dfn" href="#dfn-container" class="internalDFN" id="ref-for-dfn-container-4">MiniApp ZIP containers</a>.</li>
            <li>The file system of a package <em class="rfc2119">MAY</em> contain other subdirectories and files of different nature as defined in the <a href="#sec-filestructure">Directory and File System Structure</a> section.</li>
        </ul>
        <section id="sec-filestructure">
            <h3 id="x2-1-directory-and-file-system-structure"><bdi class="secno">2.1 </bdi>Directory and File System Structure<a class="self-link" aria-label="§" href="#sec-filestructure"></a></h3>
            <p>The <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-13">MiniApp package</a> has a file structure with some restrictions and reserved files and subdirectories.</p> 
            <p>The following example shows a typical file system structure:</p>
            <div class="example" id="example-file-sytem-structure">
        <div class="marker">
    <a class="self-link" href="#example-file-sytem-structure">Example<bdi> 1</bdi></a><span class="example-title">: File sytem structure</span>
  </div> <pre aria-busy="false"><code class="hljs">/
|___manifest.json
|___app.js
|___app.css
|___pages/
|       |___page1.js
|       |___page1.html
|       |___page1.css
|___common/
|       |___componentA.js
|       |___componentA.html
|       |___componentA.css
|       |___example.png
|___i18n/
        |___zh-Hans.json
        |___en-US.json</code></pre>
      </div>
            <section id="root-directory">
                <h4 id="x2-1-1-root-directory"><bdi class="secno">2.1.1 </bdi>Root Directory<a class="self-link" aria-label="§" href="#root-directory"></a></h4>
                <p>The <dfn id="dfn-root-directory" data-lt="root directory|root directories|MiniApp root directories|MiniApp root directory" data-dfn-type="dfn" tabindex="0" aria-haspopup="dialog">MiniApp root directory</dfn> is the base directory of the <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-14">MiniApp package</a> file system.</p> 

                <p>The <a data-link-type="dfn" href="#dfn-root-directory" class="internalDFN" id="ref-for-dfn-root-directory-7">root directory</a> of a <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-15">MiniApp package</a> holds several reserved files that include global data and information about the lifecycle management of the MiniApp, including:</p>
                <dl data-cite="MINIAPP-MANIFEST">
                    <dt><code>manifest.json</code></dt>
                    <dd>The <a href="https://www.w3.org/TR/miniapp-manifest/#dfn-miniapp-manifest-s" data-link-type="dfn">MiniApp manifest</a> is a JSON document responsible for the global configuration of the MiniApp. A manifest file contains a collection of mandatory and optional attributes that indicate the setup of the MiniApp, including routes and paths of the pages and the window configuration of the MiniApp (e.g., styles of the navigation bar, background image, background color, page title, among others), according to the MiniApp Manifest specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-miniapp-manifest" title="MiniApp Manifest">MINIAPP-MANIFEST</a></cite>].</dd>
                    <dt><code>app.css</code></dt>
                    <dd>This file is the main stylesheet of the application, where developers define common styles and look and feel aspects of the <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-2">pages</a> within the MiniApp. It <em class="rfc2119">MAY</em> be empty.</dd>
                    <dt><code>app.js</code></dt>
                    <dd>This script document has the basic service logic of the MiniApp and includes the essential configuration and control of the MiniApp lifecycle [<cite><a class="bibref" data-link-type="biblio" href="#bib-miniapp-lifecycle" title="MiniApp Lifecycle">MINIAPP-LIFECYCLE</a></cite>], including the management of events for launching, showing, and hiding the MiniApp.</dd>
                </dl>
            </section>
            <section id="sec-pages-directory">
                <h4 id="x2-1-2-pages-directory"><bdi class="secno">2.1.2 </bdi><code>pages</code> Directory<a class="self-link" aria-label="§" href="#sec-pages-directory"></a></h4>
                <p>The <code>pages</code> directory contains a set of files for the display and user interaction of the <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-3">MiniApp pages</a>.</p>
                <p>A <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-4">MiniApp page</a> is defined by a set of <a data-link-type="dfn" href="#dfn-resource" class="internalDFN" id="ref-for-dfn-resource-5">resources</a>, whose files are identified by a unique filename (e.g., <code>intro</code>) and a specific extension that defines the <a data-link-type="dfn" href="#dfn-resource" class="internalDFN" id="ref-for-dfn-resource-6">resource</a> type, such as the business logic of the application (e.g., <code>intro.js</code>), the structure and content (e.g., <code>intro.html</code>), and the scoped stylesheet (e.g., <code>intro.css</code>).</p>
                <p>Developers <em class="rfc2119">MAY</em> include other types of <a data-link-type="dfn" href="#dfn-resource" class="internalDFN" id="ref-for-dfn-resource-7">resources</a> according to their needs. Also, the files related to a page (identified with the same filename) <em class="rfc2119">MAY</em> be organized either in specific subdirectories for each page or stored under the <code>pages</code> directory directly.</p>
                <div class="example" id="example-page-resources-directly-in-the-pages-directory">
        <div class="marker">
    <a class="self-link" href="#example-page-resources-directly-in-the-pages-directory">Example<bdi> 2</bdi></a><span class="example-title">: Page resources directly in the pages directory</span>
  </div> <pre aria-busy="false"><code class="hljs">/
|___manifest.json
|___app.js
|___app.css
|___pages/
        |___detail.js
        |___detail.html
        |___detail.css
        |___list.js
        |___list.html
        |___list.css</code></pre>
      </div>                
                <div class="example" id="example-page-resources-organized-in-subdirectories">
        <div class="marker">
    <a class="self-link" href="#example-page-resources-organized-in-subdirectories">Example<bdi> 3</bdi></a><span class="example-title">: Page resources organized in subdirectories</span>
  </div> <pre aria-busy="false"><code class="hljs">/
|___manifest.json
|___app.js
|___app.css
|___pages/
        |___detail/
                |___detail.js
                |___detail.html
                |___detail.css
        |___list
                |___list.js
                |___list.html
                |___list.css</code></pre>
      </div>                
                <ul>
                    <li>A <code>.html</code> resource defines the structure and content of a <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-5">MiniApp page</a>. Based on HTML, the syntax, structure, and other requirements of this type of file are defined in the <a href="#sec-miniapp-resources-html">HTML Resources</a> section.</li>
                    <li>A <code>.css</code> resource defines the stylesheet of a <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-6">MiniApp page</a>. The syntax, structure, and other requirements of this type of resource are defined in the <a href="#sec-miniapp-resources-css">CSS Resources</a> section.</li>
                    <li>A <code>.js</code> resource contains the business logic of the <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-7">MiniApp page</a>, including functions, data, and other configuration aspects needed for the operation of the application. This type of resource is responsible for the setup and lifecycle management of <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-8">MiniApp pages</a>, as defined in the MiniApp Lifecycle specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-miniapp-lifecycle" title="MiniApp Lifecycle">MINIAPP-LIFECYCLE</a></cite>]. The syntax and format of these types of files are defined in the <a href="#sec-miniapp-resources-js">Scripting Resources</a> section.</li>
                </ul>
            </section>
            <section id="common-directory">
                <h4 id="x2-1-3-common-directory"><bdi class="secno">2.1.3 </bdi><code>common</code> Directory<a class="self-link" aria-label="§" href="#common-directory"></a></h4>
                <p>The optional <code>common</code> directory contains <a data-link-type="dfn" href="#dfn-resource" class="internalDFN" id="ref-for-dfn-resource-8">resources</a>, such as components, multimedia resources, documents and libraries that are accessible from the <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-9">pages</a> in a MiniApp. The internal structure of this directory is flexible, so these common resources <em class="rfc2119">MAY</em> be organized in customized subdirectories and using different name conventions, as needed.</p>
            </section>
            <section id="i18n-directory">
                <h4 id="x2-1-4-i18n-directory"><bdi class="secno">2.1.4 </bdi><code><abbr title="internationalization">i18n</abbr></code> Directory<a class="self-link" aria-label="§" href="#i18n-directory"></a></h4>
                <p>The optional <dfn id="dfn-i18n-directory" data-dfn-type="dfn" tabindex="0" aria-haspopup="dialog"><abbr title="internationalization">i18n</abbr> directory</dfn> is a subdirectory in the <a data-link-type="dfn" href="#dfn-root-directory" class="internalDFN" id="ref-for-dfn-root-directory-8">root directory</a> that includes the <a data-link-type="dfn" href="#dfn-localization-resources" class="internalDFN" id="ref-for-dfn-localization-resources-2">localization resources</a> of a <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-16">MiniApp package</a>.</p>
                <p>The <a data-link-type="dfn" href="#dfn-i18n-directory" class="internalDFN" id="ref-for-dfn-i18n-directory-1">i18n Directory</a> contains multi-language <a data-link-type="dfn" href="#dfn-localization-resources" class="internalDFN" id="ref-for-dfn-localization-resources-3">localization resources</a> to support the internationalization of the MiniApp contents. The filename of each <code>.json</code> document in this directory follows the <code>Language-Tag</code> notation as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-bcp47" title="Tags for Identifying Languages">BCP47</a></cite>] and represents the specific configuration for that particular language.</p>
                <p>The <a data-link-type="dfn" href="#dfn-i18n-directory" class="internalDFN" id="ref-for-dfn-i18n-directory-2">i18n Directory</a> <em class="rfc2119">MAY</em> contain as many <a data-link-type="dfn" href="#dfn-localization-resources" class="internalDFN" id="ref-for-dfn-localization-resources-4">localization resources</a> as languages or locales a MiniApp supports. The format of these files is defined in the <a href="#sec-miniapp-resources-i18n">localization resources</a> section.</p> 
            </section>
            <section id="file-names">
                <h4 id="x2-1-5-file-names"><bdi class="secno">2.1.5 </bdi>File Names<a class="self-link" aria-label="§" href="#file-names"></a></h4>
                <p>Any <a data-link-type="dfn" href="#dfn-filename" class="internalDFN" id="ref-for-dfn-filename-1">file name</a> within a <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-17">MiniApp package</a> <em class="rfc2119">MUST</em> comply with the following restrictions to accommodate the potential limitations of the operating systems and facilitate compatibility with the majority of the platforms:</p>

                <ul class="conformance-list">
                    <li><a data-link-type="dfn" href="#dfn-filename" class="internalDFN" id="ref-for-dfn-filename-2">File names</a> are case sensitive.</li>
                    <li><a data-link-type="dfn" href="#dfn-filename" class="internalDFN" id="ref-for-dfn-filename-3">File names</a> <em class="rfc2119">MUST</em> be UTF-8 [<cite><a class="bibref" data-link-type="biblio" href="#bib-unicode" title="The Unicode Standard">Unicode</a></cite>] encoded.</li>
                    <li><a data-link-type="dfn" href="#dfn-filename" class="internalDFN" id="ref-for-dfn-filename-4">File names</a> <em class="rfc2119">MUST NOT</em> exceed 255 bytes.</li>
                    <li>The path name for any directory or file within a <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-18">MiniApp package</a> <em class="rfc2119">MUST NOT</em> exceed 65535 bytes.</li>
                    <li><a data-link-type="dfn" href="#dfn-filename" class="internalDFN" id="ref-for-dfn-filename-5">File names</a> <em class="rfc2119">MUST NOT</em> use the following [<cite><a class="bibref" data-link-type="biblio" href="#bib-unicode" title="The Unicode Standard">Unicode</a></cite>] characters:
                        <ul>
							<li>
								<p>SOLIDUS: <code>/</code> (<code>U+002F</code>)</p>
							</li>
							<li>
								<p>QUOTATION MARK: <code>"</code> (<code>U+0022</code>)</p>
							</li>
							<li>
								<p>ASTERISK: <code>*</code> (<code>U+002A</code>)</p>
							</li>
							<li>
								<p>FULL STOP as the last character: <code>.</code> (<code>U+002E</code>)</p>
							</li>
							<li>
								<p>COLON: <code>:</code> (<code>U+003A</code>)</p>
							</li>
							<li>
								<p>LESS-THAN SIGN: <code>&lt;</code> (<code>U+003C</code>)</p>
							</li>
							<li>
								<p>GREATER-THAN SIGN: <code>&gt;</code> (<code>U+003E</code>)</p>
							</li>
							<li>
								<p>QUESTION MARK: <code>?</code> (<code>U+003F</code>)</p>
							</li>
							<li>
								<p>REVERSE SOLIDUS: <code>\</code> (<code>U+005C</code>)</p>
							</li>
							<li>
								<p>VERTICAL LINE: <code>\</code> (<code>U+007C</code>)</p>
							</li>
							<li>
								<p>DEL (<code>U+007F</code>)</p>
							</li>
							<li>
								<p>C0 range (<code>U+0000 … U+001F</code>)</p>
							</li>
							<li>
								<p>C1 range (<code>U+0080 … U+009F</code>)</p>
							</li>
							<li>
								<p>Private Use Area (<code>U+E000 … U+F8FF</code>)</p>
							</li>
							<li>
								<p>Non characters in Arabic Presentation Forms-A (<code>U+FDD0 … U+FDEF</code>)</p>
							</li>
							<li>
								<p>Specials (<code>U+FFF0 … U+FFFF</code>)</p>
							</li>
							<li>
								<p>Tags and Variation Selectors Supplement (<code>U+E0000 … U+E0FFF</code>)</p>
							</li>
							<li>
								<p>Supplementary Private Use Area-A (<code>U+F0000 … U+FFFFF</code>)</p>
							</li>
							<li>
								<p>Supplementary Private Use Area-B (<code>U+100000 … U+10FFFF</code>)</p>
							</li>
                        </ul>
                    </li>
                </ul>
                <p id="filename-normalization">All <a data-link-type="dfn" href="#dfn-filename" class="internalDFN" id="ref-for-dfn-filename-6">file names</a> within the same directory <em class="rfc2119">MUST</em> be unique following Unicode canonical normalization [<cite><a class="bibref" data-link-type="biblio" href="#bib-uax15" title="Unicode Normalization Forms">UAX15</a></cite>] and then full case folding [<cite><a class="bibref" data-link-type="biblio" href="#bib-unicode" title="The Unicode Standard">Unicode</a></cite>]. (Refer to <a href="https://www.w3.org/TR/charmod-norm/#CanonicalFoldNormalizationStep">Unicode Canonical Case Fold Normalization Step</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-charmod-norm" title="Character Model for the World Wide Web: String Matching">CHARMOD-NORM</a></cite>] for more information.)</p>                
                <div class="note" role="note" id="issue-container-generatedID"><div role="heading" class="note-title marker" id="h-note" aria-level="5"><span>Note</span><span class="issue-label">: Limiting the length of file names</span></div><div class="">
                    If a MiniApp vendor imposes length limits on path and <a data-link-type="dfn" href="#dfn-filename" class="internalDFN" id="ref-for-dfn-filename-7">file names</a>, it is important to avoid mid-character truncation due to the difference between bytes and characters in multibyte encodings such as UTF-8. See <a href="https://www.w3.org/TR/international-specs/#char_truncation">the text truncation best practice</a> for more information.     
                </div></div>
            </section>
        </section>
        <section id="sec-miniapp-resources">
            <h3 id="x2-2-miniapp-resources"><bdi class="secno">2.2 </bdi>MiniApp Resources<a class="self-link" aria-label="§" href="#sec-miniapp-resources"></a></h3>
            <p>A <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-10">MiniApp page</a> is composed of, at least, an <a data-link-type="dfn" href="#dfn-html-resource" class="internalDFN" id="ref-for-dfn-html-resource-1">HTML resource</a> and, optionally, a <a data-link-type="dfn" href="#dfn-css-resource" class="internalDFN" id="ref-for-dfn-css-resource-1">CSS resource</a> and/or a <a data-link-type="dfn" href="#dfn-js-resource" class="internalDFN" id="ref-for-dfn-js-resource-1">scripting resource</a>. These related resources <em class="rfc2119">MUST</em> have the same path and filename (only changing the file extension) to identify the <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-11">MiniApp page</a> through a unique <a href="https://www.w3.org/TR/miniapp-manifest/#dfn-page-route" data-link-type="dfn">page route</a> that needs to be specified in the <a href="https://www.w3.org/TR/miniapp-manifest/#pages-member" data-link-type="dfn"><code>pages</code> member</a> of the <a href="https://www.w3.org/TR/miniapp-manifest/#dfn-miniapp-manifest-s" data-link-type="dfn">MiniApp manifest</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-miniapp-manifest" title="MiniApp Manifest">MINIAPP-MANIFEST</a></cite>]. </p>
            <div class="example" id="example-organization-of-page-resources-corresponding-to-the-page-route-pages-product-product">
        <div class="marker">
    <a class="self-link" href="#example-organization-of-page-resources-corresponding-to-the-page-route-pages-product-product">Example<bdi> 4</bdi></a><span class="example-title">: Organization of page resources corresponding to the page route 'pages/product/product'</span>
  </div> <pre aria-busy="false"><code class="hljs">/
|___pages/
        |___product/
                |___product.html
                |___product.css
                |___product.js</code></pre>
      </div>
            <section id="sec-miniapp-resources-html">
                <h4 id="x2-2-1-html-resources"><bdi class="secno">2.2.1 </bdi>HTML Resources<a class="self-link" aria-label="§" href="#sec-miniapp-resources-html"></a></h4>
                <p><dfn id="dfn-html-resource" data-lt="MiniApp HTML resource|MiniApp HTML resources|HTML resource|HTML resources" data-dfn-type="dfn" data-plurals="html resource" tabindex="0" aria-haspopup="dialog">HTML resources</dfn> are documents that contain markup and information to define <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-12">MiniApp pages</a>, and their user interfaces, including the structure, visual components, and interaction elements.</p>
                <p><a data-link-type="dfn" href="#dfn-html-resource" class="internalDFN" id="ref-for-dfn-html-resource-2">HTML resources</a> <em class="rfc2119">MUST</em> meet all the following criteria:</p>
                <dl class="conformance-list">
                    <dt>Syntax and content</dt>
                    <dd>An <a data-link-type="dfn" href="#dfn-html-resource" class="internalDFN" id="ref-for-dfn-html-resource-3">HTML resource</a> <em class="rfc2119">MUST</em> use the <a href="https://html.spec.whatwg.org/multipage/syntax.html#syntax">HTML syntax</a> defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>].</dd>
                    <dt>File name</dt>
                    <dd>An <a data-link-type="dfn" href="#dfn-html-resource" class="internalDFN" id="ref-for-dfn-html-resource-4">HTML resource</a> <em class="rfc2119">SHOULD</em> have a unique filename that identifies a single <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-13">MiniApp page</a> and matches with the corresponding <a data-link-type="dfn" href="#dfn-css-resource" class="internalDFN" id="ref-for-dfn-css-resource-2">CSS resource</a> and <a data-link-type="dfn" href="#dfn-js-resource" class="internalDFN" id="ref-for-dfn-js-resource-2">scripting resource</a> of the page if present.</dd>
                    <dt>File extension</dt>
                    <dd>An <a data-link-type="dfn" href="#dfn-html-resource" class="internalDFN" id="ref-for-dfn-html-resource-5">HTML resource</a> <em class="rfc2119">SHOULD</em> use the file extension <code>.html</code>.</dd>
                </dl>
                <div class="note" id="issue-container-generatedID-0"><div role="heading" class="ednote-title marker" id="h-ednote" aria-level="5"><span>Editor's note</span></div><div class="">
                    To define the HTML profile of MiniApp Content Documents.
                </div></div> 
            </section>
            <section id="sec-miniapp-resources-css">
                <h4 id="x2-2-2-css-resources"><bdi class="secno">2.2.2 </bdi>CSS Resources<a class="self-link" aria-label="§" href="#sec-miniapp-resources-css"></a></h4>
                <p><dfn id="dfn-css-resource" data-lt="MiniApp CSS resource|MiniApp CSS resources|CSS resources" data-dfn-type="dfn" data-plurals="css resource" tabindex="0" aria-haspopup="dialog">CSS resources</dfn> are stylesheets that describe the rendering and appearance of <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-14">MiniApp pages</a>. CSS resources can be global, affecting all the pages in a MiniApp (i.e., <code>app.css</code> in the <a data-link-type="dfn" href="#dfn-root-directory" class="internalDFN" id="ref-for-dfn-root-directory-9">root directory</a>), or with local scope, just affecting a specific <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-15">page</a> in the MiniApp.</p>
                <p>This specification supports the CSS modules as defined in the [<cite><a class="bibref" data-link-type="biblio" href="#bib-css-snapshot" title="CSS Snapshot">CSS-SNAPSHOT</a></cite>].</p>
                <p>CSS resources <em class="rfc2119">MUST</em> meet all the following criteria:</p>
                <dl class="conformance-list">                    
                    <dt>Syntax and content</dt>
                    <dd>A <a data-link-type="dfn" href="#dfn-css-resource" class="internalDFN" id="ref-for-dfn-css-resource-3">CSS resource</a> <em class="rfc2119">MUST</em> follow described using the syntax and definitions of CSS as described in the [<cite><a class="bibref" data-link-type="biblio" href="#bib-css-snapshot" title="CSS Snapshot">CSS-SNAPSHOT</a></cite>].</dd>
                    <dt>File name</dt>
                    <dd>The global <a data-link-type="dfn" href="#dfn-css-resource" class="internalDFN" id="ref-for-dfn-css-resource-4">CSS resource</a>, affecting all <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-16">pages</a> in a MiniApp, <em class="rfc2119">MUST</em> be named <code>app.css</code> and stored in the <a data-link-type="dfn" href="#dfn-root-directory" class="internalDFN" id="ref-for-dfn-root-directory-10">root directory</a>.</dd>
                    <dd>A local <a data-link-type="dfn" href="#dfn-css-resource" class="internalDFN" id="ref-for-dfn-css-resource-5">CSS resource</a> associated with a <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-17">page</a> <em class="rfc2119">SHOULD</em> have a unique filename that identifies the <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-18">MiniApp page</a> and matches with the corresponding <a data-link-type="dfn" href="#dfn-html-resource" class="internalDFN" id="ref-for-dfn-html-resource-6">HTML resource</a> and <a data-link-type="dfn" href="#dfn-js-resource" class="internalDFN" id="ref-for-dfn-js-resource-3">scripting resource</a> if present.</dd>
                    <dt>File extension</dt>
                    <dd>A <a data-link-type="dfn" href="#dfn-css-resource" class="internalDFN" id="ref-for-dfn-css-resource-6">CSS resource</a> filename <em class="rfc2119">SHOULD</em> use the file extension <code>.css</code>.</dd>
                </dl>
            </section>
            <section id="sec-miniapp-resources-js">
                <h4 id="x2-2-3-scripting-resources"><bdi class="secno">2.2.3 </bdi>Scripting Resources<a class="self-link" aria-label="§" href="#sec-miniapp-resources-js"></a></h4>
                <p><dfn id="dfn-js-resource" data-lt="MiniApp scripting resource|Scripting resources" data-dfn-type="dfn" data-plurals="scripting resource" tabindex="0" aria-haspopup="dialog">Scripting resources</dfn> are documents that contain script elements and data to control the business logic and functionality of the application, adding interactivity and managing the lifecycle of the MiniApp. There is a global <a data-link-type="dfn" href="#dfn-js-resource" class="internalDFN" id="ref-for-dfn-js-resource-4">scripting resource</a> (i.e., <code>app.js</code> in the <a data-link-type="dfn" href="#dfn-root-directory" class="internalDFN" id="ref-for-dfn-root-directory-11">root directory</a>) that includes data and functions available for all the <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-19">pages</a> of the MiniApp, and with specific logic to control the application's lifecycle. Each <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-20">MiniApp page</a> <em class="rfc2119">MAY</em> have associated specific <a data-link-type="dfn" href="#dfn-js-resource" class="internalDFN" id="ref-for-dfn-js-resource-5">scripting resources</a>, with the scope limited to the concrete <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-21">page</a>.</p>
                <p>Scripting resources <em class="rfc2119">MUST</em> meet all the following criteria:</p>
                <dl class="conformance-list">
                    <dt>Syntax and content</dt>
                    <dd>The <a data-link-type="dfn" href="#dfn-js-resource" class="internalDFN" id="ref-for-dfn-js-resource-6">scripting resources</a> <em class="rfc2119">MUST</em> conform with the requirements of the ECMAScript specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-ecma-262" title="ECMAScript Language Specification">ECMA-262</a></cite>].</dd>
                    <dd>The global <a data-link-type="dfn" href="#dfn-js-resource" class="internalDFN" id="ref-for-dfn-js-resource-7">scripting resource</a> <em class="rfc2119">MUST</em> be named <code>app.js</code> and stored in the <a data-link-type="dfn" href="#dfn-root-directory" class="internalDFN" id="ref-for-dfn-root-directory-12">root directory</a>.</dd>
                    <dd>A local <a data-link-type="dfn" href="#dfn-js-resource" class="internalDFN" id="ref-for-dfn-js-resource-8">scripting resource</a> associated with a <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-22">page</a> <em class="rfc2119">SHOULD</em> have a unique filename that identifies the <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-23">MiniApp page</a> and matches with the corresponding <a data-link-type="dfn" href="#dfn-html-resource" class="internalDFN" id="ref-for-dfn-html-resource-7">HTML resource</a> and <a data-link-type="dfn" href="#dfn-css-resource" class="internalDFN" id="ref-for-dfn-css-resource-7">CSS resource</a> if present.</dd>
                    <dt>File extension</dt>
                    <dd>A <a data-link-type="dfn" href="#dfn-js-resource" class="internalDFN" id="ref-for-dfn-js-resource-9">scripting resource</a> filename <em class="rfc2119">SHOULD</em> use the file extension <code>.js</code>.</dd>
                </dl>
            </section>
            <section id="sec-miniapp-resources-i18n">
                <h4 id="x2-2-4-localization-resources"><bdi class="secno">2.2.4 </bdi>Localization Resources<a class="self-link" aria-label="§" href="#sec-miniapp-resources-i18n"></a></h4>
                <p>A <dfn id="dfn-localization-resources" data-lt="MiniApp localization resources|Localization resources|localization resources|MiniApp localization resource" data-dfn-type="dfn" data-plurals="localization resource" tabindex="0" aria-haspopup="dialog">MiniApp localization resource</dfn> is a document of a <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-19">MiniApp package</a> that included localized content as part of the <a data-link-type="dfn" href="#dfn-i18n" class="internalDFN" id="ref-for-dfn-i18n-1">internationalization</a> mechanism of MiniApps.</p>
                <p>A multilingual MiniApp <em class="rfc2119">MAY</em> has several <a data-link-type="dfn" href="#dfn-localization-resources" class="internalDFN" id="ref-for-dfn-localization-resources-5">localization resources</a> that will be used during the <a data-link-type="dfn" href="#dfn-localization" class="internalDFN" id="ref-for-dfn-localization-1">localization</a> process by the <a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-9">user agents</a> to render content according to the system locale or the user's language preferences. These resources contain JSON objects with key-value pairs that contain the unique identifier (the key) of a localizable term or expression and the representation in the concrete language (the value).</p>
                <div class="example" id="example-localization-resource">
        <div class="marker">
    <a class="self-link" href="#example-localization-resource">Example<bdi> 5</bdi></a><span class="example-title">: Localization resource</span>
  </div> <pre aria-busy="false"><code class="hljs json">{
    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Cool MiniApp"</span>,
    <span class="hljs-attr">"about"</span>: <span class="hljs-string">"About this MiniApp"</span>,
    <span class="hljs-attr">"intro-page"</span>: {
        <span class="hljs-attr">"title"</span> : <span class="hljs-string">"Introduction"</span>,
        <span class="hljs-attr">"main"</span> : <span class="hljs-string">"This is the body of the page"</span>
    }
}</code></pre>
      </div>
                <p><a data-link-type="dfn" href="#dfn-localization-resources" class="internalDFN" id="ref-for-dfn-localization-resources-6">Localization resources</a> <em class="rfc2119">MUST</em> meet all the following criteria:</p>
                <dl class="conformance-list">
                    <dt>File extension</dt>
                    <dd>A <a data-link-type="dfn" href="#dfn-localization-resources" class="internalDFN" id="ref-for-dfn-localization-resources-7">localization resource</a> filename <em class="rfc2119">SHOULD</em> use the file extension <code>.json</code>.</dd>
                    <dt>Format</dt>
                    <dd>A <a data-link-type="dfn" href="#dfn-localization-resources" class="internalDFN" id="ref-for-dfn-localization-resources-8">localization resource</a> <em class="rfc2119">MUST</em> be a valid JSON document [<cite><a class="bibref" data-link-type="biblio" href="#bib-json" title="The JavaScript Object Notation (JSON) Data Interchange Format">JSON</a></cite>].</dd>
                    <dt>Structure</dt>
                    <dd>A <a data-link-type="dfn" href="#dfn-localization-resources" class="internalDFN" id="ref-for-dfn-localization-resources-9">localization resource</a> <em class="rfc2119">MUST</em> be composed of key-value pairs. Each key represents a unique identifier for each localizable string (the values).</dd>
                </dl>
            </section>
        </section> 
    </section>
  <section id="sec-miniapp-zip-container">
      <h2 id="x3-miniapp-zip-container"><bdi class="secno">3. </bdi>MiniApp ZIP Container<a class="self-link" aria-label="§" href="#sec-miniapp-zip-container"></a></h2>
        <section id="sec-miniapp-zip-container-intro" class="informative">
            <h3 id="x3-1-introduction"><bdi class="secno">3.1 </bdi>Introduction<a class="self-link" aria-label="§" href="#sec-miniapp-zip-container-intro"></a></h3><p><em>This section is non-normative.</em></p>
            <p>A <a data-link-type="dfn" href="#dfn-container" class="internalDFN" id="ref-for-dfn-container-5">MiniApp ZIP container</a> is a physical single-file representation of a MiniApp that can be used to distribute it in different scenarios, including:</p>
            <ul>
                <li>An organization that stores and lists catalogs of MiniApps (i.e., marketplace);</li>
                <li>A developer that builds a MiniApp and delivers it to a marketplace;</li>
                <li>A developer that shares a MiniApp with the <abbr title="Quality Assurance">QA</abbr> department for testing.</li>
            </ul>
            <p>A <a data-link-type="dfn" href="#dfn-container" class="internalDFN" id="ref-for-dfn-container-6">MiniApp ZIP container</a> contains all the resources that conforms a MiniApp, according to the <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-20">MiniApp package</a> structure in a single file. This format supports the use of compression mechanisms.</p>
        </section>
        <section id="sec-miniapp-zip-file-requirements">
            <h3 id="x3-2-zip-file-requirements"><bdi class="secno">3.2 </bdi>ZIP File Requirements<a class="self-link" aria-label="§" href="#sec-miniapp-zip-file-requirements"></a></h3>
            <p>A <a data-link-type="dfn" href="#dfn-container" class="internalDFN" id="ref-for-dfn-container-7">MiniApp ZIP container</a> uses the ZIP format as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-zip" title=".ZIP File Format Specification">ZIP</a></cite>], including some particularities:</p>
        	<ul class="conformance-list">
                <li>The contents of the <a data-link-type="dfn" href="#dfn-container" class="internalDFN" id="ref-for-dfn-container-8">MiniApp ZIP container</a> <em class="rfc2119">MUST</em> be a conforming <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-21">MiniApp package</a>.</li>
                <li>MiniApp ZIP containers <em class="rfc2119">MUST NOT</em> use the ZIP encryption mechanisms.</li>
                <li>Data integrity <em class="rfc2119">MUST</em> be provided for each file using CRC32 as specified in [<cite><a class="bibref" data-link-type="biblio" href="#bib-zip" title=".ZIP File Format Specification">ZIP</a></cite>].</li>
                <li>MiniApp ZIP containers <em class="rfc2119">MUST NOT</em> use the features in the ZIP application note [<cite><a class="bibref" data-link-type="biblio" href="#bib-zip" title=".ZIP File Format Specification">ZIP</a></cite>] that allow ZIP files to be spanned across multiple storage media, or split into multiple files.</li>
                <li>MiniApp ZIP containers <em class="rfc2119">MUST</em> include ZIP uncompressed (method <code>0</code>, file stored) and Deflate-compressed (method <code>0</code>, lossless data compression) contents within the ZIP archive, according to the [<cite><a class="bibref" data-link-type="biblio" href="#bib-zip" title=".ZIP File Format Specification">ZIP</a></cite>] specification.</li>
                <li>MiniApp ZIP containers <em class="rfc2119">MUST</em> use UTF-8 [<cite><a class="bibref" data-link-type="biblio" href="#bib-unicode" title="The Unicode Standard">Unicode</a></cite>] for encoding file names.</li>
                <li>MiniApp ZIP containers <em class="rfc2119">MUST NOT</em> use patented features.</li>
                <li>MiniApp ZIP containers <em class="rfc2119">MAY</em> include a special block, the <a data-link-type="dfn" href="#dfn-signing_block" class="internalDFN" id="ref-for-dfn-signing_block-1">MiniApp signing block</a>, to allow digital signatures affecting the whole package.</li>
                <li>The minimum version of ZIP to extract a <a data-link-type="dfn" href="#dfn-container" class="internalDFN" id="ref-for-dfn-container-9">MiniApp ZIP container</a> is <code>2.0</code> (supporting folders and Deflate compression), according to the [<cite><a class="bibref" data-link-type="biblio" href="#bib-zip" title=".ZIP File Format Specification">ZIP</a></cite>] specification.</li>
            </ul>
            <p>The structure of a MiniApp ZIP container is as follows:</p>
            <pre aria-busy="false"><code class="hljs json">[ZIP File Entries]
[MiniApp Signing Block]    
[ZIP Central Directory]
[End of ZIP Central Directory]</code></pre>

            <figure id="figure-zip-summary">
                <img src="images/signature_zip_summary.svg" alt="Structure of standard ZIP package and the MiniApp package with a signing block in the middle" height="444" width="1112">
                <figcaption>Figure <bdi class="figno">1</bdi> <span class="fig-title">ZIP package and MiniApp package with an optional signing block</span></figcaption>
            </figure>

            <p>The <a data-link-type="dfn" href="#dfn-container" class="internalDFN" id="ref-for-dfn-container-10">MiniApp ZIP container</a> is parsed by first finding the start of the ZIP Central Directory (locating the ZIP End of Central Directory record at the end of the file, then reading the start offset of the Central Directory from the record). Every <a data-link-type="dfn" href="#dfn-signing_block" class="internalDFN" id="ref-for-dfn-signing_block-2">MiniApp signing block</a> <em class="rfc2119">MAY</em> include a <a data-link-type="dfn" href="#dfn-magic-numbers" class="internalDFN" id="ref-for-dfn-magic-numbers-1">signing block magic numbers</a> block, as specified in <a href="#sec-miniapp-digital-signature-requirements">Digital Signature Requirements</a>, to identify the presence of digital signatures. Once the "magic numbers" block is recognized, the <a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-10">user agent</a> would be able to <a data-link-type="dfn" href="#dfn-processing-the-digital-signatures" class="internalDFN" id="ref-for-dfn-processing-the-digital-signatures-1">process the digital signatures</a> stored in the signing block, in the immediately preceding section of the Central Directory, as shown in <a href="#figure-package-references" class="fig-ref" title="ZIP and MiniApp packages with references to the different blocks using relative offset addessing">Figure <bdi class="figno">2</bdi></a>.</p>


            <figure id="figure-package-references">
                <img src="images/signature_zip_complete.svg" alt="Structure of standard ZIP package and the MiniApp package with a signing block in the middle and references to the different blocks of the package" height="1080" width="1538">
                <figcaption>Figure <bdi class="figno">2</bdi> <span class="fig-title">ZIP and MiniApp packages with references to the different blocks using relative offset addessing</span></figcaption>
            </figure>

            <p>MiniApps vendors <em class="rfc2119">MAY</em> adopt the digital signature schemes depending on their needs.</p>  
            <div class="note" id="issue-container-generatedID-1"><div role="heading" class="ednote-title marker" id="h-ednote-0" aria-level="4"><span>Editor's note</span><span class="issue-label">: To add extension</span></div><p class="">
                MiniApp files <em class="rfc2119">MAY</em> be identified by the .ma file extension although the use of a file extension is not required.
            </p></div>    
        </section>
        <section id="sec-miniapp-digital-signature-requirements">
            <h3 id="x3-3-digital-signature-requirements"><bdi class="secno">3.3 </bdi>Digital Signature Requirements<a class="self-link" aria-label="§" href="#sec-miniapp-digital-signature-requirements"></a></h3>  
            <p>A <a data-link-type="dfn" href="#dfn-container" class="internalDFN" id="ref-for-dfn-container-11">MiniApp ZIP container</a> <em class="rfc2119">MAY</em> include none, one, or more <a data-link-type="dfn" href="#dfn-signature" class="internalDFN" id="ref-for-dfn-signature-2">signatures</a> to help to detect any changes to the protected parts of the software, guaranteeing the integrity of the MiniApp.</p>
            <p>A <dfn id="dfn-signing_block" data-lt="signing block|MiniApp signing blocks|signing blocks|MiniApp signing block" data-dfn-type="dfn" tabindex="0" aria-haspopup="dialog">MiniApp signing block</dfn> is a collection of bytes that contains specific information and metadata about the digital signature that affects a MiniApp, partially or as a whole. The <a data-link-type="dfn" href="#dfn-signing_block" class="internalDFN" id="ref-for-dfn-signing_block-3">signing block</a> of a <a data-link-type="dfn" href="#dfn-container" class="internalDFN" id="ref-for-dfn-container-12">MiniApp ZIP container</a> <em class="rfc2119">MUST</em> be located immediately before the central directory of the ZIP container, in a way that makes it easier to locate the block if exists.</p>
            <p>The <dfn id="dfn-magic-numbers" data-lt="magic numbers|signing block magic numbers" data-dfn-type="dfn" tabindex="0" aria-haspopup="dialog">signing block magic numbers</dfn> block is A 16-byte sequence with a unique fingerprint that identifies a digital signature mechanism for a <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-22">MiniApp package</a>, stored in the signing block of <a data-link-type="dfn" href="#dfn-container" class="internalDFN" id="ref-for-dfn-container-13">MiniApp ZIP container</a>.</p>
            <p>Although this document does not recommend any specific digital signature mechanism (i.e., hash algorithms, encryption methods, etc.), the <a data-link-type="dfn" href="#dfn-signing_block" class="internalDFN" id="ref-for-dfn-signing_block-4">signing block</a>, if present, <em class="rfc2119">MUST</em> meet the following criteria:</p>
        	<dl class="conformance-list">
                <dt>Signing block magic numbers</dt>
                <dd>A <a data-link-type="dfn" href="#dfn-signing_block" class="internalDFN" id="ref-for-dfn-signing_block-5">signing block</a> <em class="rfc2119">MUST</em> contains <a data-link-type="dfn" href="#dfn-magic-numbers" class="internalDFN" id="ref-for-dfn-magic-numbers-2">signing block magic numbers</a>, as the preceding block of the Central Directory to identify univocally the type of digital signature included.</dd>
            </dl>
        </section>
    </section>
    <section id="sec-miniapp-i18n">
        <h2 id="x4-internationalization"><bdi class="secno">4. </bdi>Internationalization<a class="self-link" aria-label="§" href="#sec-miniapp-i18n"></a></h2>
        <p><dfn id="dfn-i18n" data-lt="internationalization|i18n|Internationalization" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Internationalization</dfn>, abbreviated to <abbr title="internationalization">i18n</abbr>, is the process of designing and developing a product in a way that ensures it can be easily adapted for users from any culture, region, or language.</p>
        <p><dfn id="dfn-localization" data-lt="localization|Localization" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Localization</dfn> is the process of content adaptation to meet a target language or cultural requirements.</p>
        <p>MiniApps enable localization of contents using a mechanism based on localized documents placed in the reserved <a data-link-type="dfn" href="#dfn-i18n-directory" class="internalDFN" id="ref-for-dfn-i18n-directory-3">i18n Directory</a>. This mechanism allows authors to place <a data-link-type="dfn" href="#dfn-localization-resources" class="internalDFN" id="ref-for-dfn-localization-resources-10">localization resources</a>, named according to a <code>language-range</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-bcp47" title="Tags for Identifying Languages">BCP47</a></cite>] and the <code>.json</code> extension. This is, documents with the localization resources will be identified with language tags [<cite><a class="bibref" data-link-type="biblio" href="#bib-bcp47" title="Tags for Identifying Languages">BCP47</a></cite>] that represent the locale of the content. <a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-11">MiniApp user agents</a> match the language ranges held by their locales to the appropriate locale filename.</p>
        <p>The format of the <a data-link-type="dfn" href="#dfn-localization-resources" class="internalDFN" id="ref-for-dfn-localization-resources-11">localization resources</a> is defined in the <a href="#sec-miniapp-resources-i18n">localization resources</a> section.</p>
        <div class="example" id="example-filenames-based-on-language-tags-in-the-i18n-directory">
        <div class="marker">
    <a class="self-link" href="#example-filenames-based-on-language-tags-in-the-i18n-directory">Example<bdi> 6</bdi></a><span class="example-title">: Filenames based on language tags in the i18n directory</span>
  </div> <pre aria-busy="false"><code class="hljs">/
|___i18n/
|     |___en-US.json
|     |___fr-FR.json
|     |___fr.json            
|     |___ja-JP.json
|     |___zh-Hans.json</code></pre>
      </div> 
    </section>
    <section id="sec-miniapp-processing" data-cite="infra">
      <h2 id="x5-miniapp-package-processing"><bdi class="secno">5. </bdi>MiniApp Package Processing<a class="self-link" aria-label="§" href="#sec-miniapp-processing"></a></h2>
        <p>
            <a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-12">User agents</a> <em class="rfc2119">MUST</em> follow the following algorithm to dereference, parse and execute a <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-23">MiniApp package</a>. 
        </p>
        <p>To <dfn id="dfn-process-a-miniapp-package" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">process a MiniApp package</dfn>, given <a data-link-type="dfn" data-type="dfn" href="https://url.spec.whatwg.org/#concept-url">URL</a> <var data-type="URL">miniapp_uri</var>, perform the following steps:</p>
        <ol class="algorithm">
            <li>Let <var data-type="MiniApp ZIP container">miniapp_zip_file</var> be the result of <a data-link-type="dfn" href="#dfn-retrieving-a-miniapp-zip-container" class="internalDFN" id="ref-for-dfn-retrieving-a-miniapp-zip-container-1">retrieving a MiniApp ZIP container</a> with <var data-type="URL">miniapp_uri</var>.</li>
            <li><a data-link-type="dfn" href="#dfn-verifying-a-miniapp-zip-container" class="internalDFN" id="ref-for-dfn-verifying-a-miniapp-zip-container-1">Verify a MiniApp ZIP container</a> with <var data-type="MiniApp ZIP container">miniapp_zip_file</var>.</li>
            <li>Let <var data-type="Miniapp package">miniapp_package</var> be the result of unzipping the <var data-type="MiniApp ZIP container">miniapp_zip_file</var>.</li>
            <li>If <var data-type="Miniapp package">miniapp_package</var> is an unzip exception, then return failure.</li>
            <li>Let <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">ordered map</a> <var data-type="ordered map">manifest</var> be the result of <a data-link-type="dfn" href="#dfn-processing-the-miniapp-manifest" class="internalDFN" id="ref-for-dfn-processing-the-miniapp-manifest-1">processing the MiniApp manifest</a> with <var data-type="Miniapp package">miniapp_package</var>.</li>
            <li>Let <var data-type="MiniApp start page">start_page</var> be the result of <a data-link-type="dfn" href="#dfn-preparing-the-platform-runtime" class="internalDFN" id="ref-for-dfn-preparing-the-platform-runtime-1">preparing the platform runtime</a> with <var data-type="URL">miniapp_uri</var> and <var data-type="ordered map">manifest</var>.</li>
            <li>Let <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#string">string</a> <var data-type="string">locale</var> be the result of <a data-link-type="dfn" href="#dfn-extracting-the-locale" class="internalDFN" id="ref-for-dfn-extracting-the-locale-1">extracting the locale</a>, passing <var data-type="ordered map">manifest</var>.</li>
            <li>Launch MiniApp passing <var data-type="Miniapp package">miniapp_package</var>, <var data-type="ordered map">manifest</var>, <var data-type="MiniApp start page">start_page</var>, and <var data-type="string">locale</var>.</li>
        </ol>

        <section id="sec-miniapp-processing-retrieval">
            <h3 id="x5-1-miniapp-zip-container-retrieval"><bdi class="secno">5.1 </bdi>MiniApp ZIP Container Retrieval<a class="self-link" aria-label="§" href="#sec-miniapp-processing-retrieval"></a></h3>
            <p><a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-13">User agents</a> <em class="rfc2119">MAY</em> obtain <a data-link-type="dfn" href="#dfn-container" class="internalDFN" id="ref-for-dfn-container-14">MiniApp ZIP containers</a> through different channels, retrieving the file over the network (i.e., using HTTPs, WebSocket, FTP, or other specific TCP/UDP based protocols), also from the filesystem or using any other mechanism.</p>
            <p>To <dfn data-lt="retrieving a MiniApp ZIP container|retrieve a MiniApp ZIP container" data-dfn-type="dfn" id="dfn-retrieving-a-miniapp-zip-container" tabindex="0" aria-haspopup="dialog">retrieve a MiniApp ZIP container</dfn>, given <a data-link-type="dfn" data-type="dfn" href="https://url.spec.whatwg.org/#concept-url">URL</a> <var data-type="URL">miniapp_uri</var>, perform the following steps. They return a <a data-link-type="dfn" href="#dfn-container" class="internalDFN" id="ref-for-dfn-container-15">MiniApp ZIP container</a>.</p>
            <ol class="algorithm">
                <li>Let <var data-type="MiniApp ZIP container">resource</var> be a <a data-link-type="dfn" href="#dfn-container" class="internalDFN" id="ref-for-dfn-container-16">MiniApp ZIP container</a> as a result of <a href="https://fetch.spec.whatwg.org/#concept-fetch">fetching a URL</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-fetch" title="Fetch Standard">FETCH</a></cite>], passing <var data-type="URL">miniapp_uri</var>.</li>
                <li>Let <var data-type="string">supplied_mime_type</var> be the result of applying the <a href="https://mimesniff.spec.whatwg.org/#supplied-mime-type-detection-algorithm">supplied MIME type detection algorithm</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-mimesniff" title="MIME Sniffing Standard">MIMESNIFF</a></cite>] with <var data-type="MiniApp ZIP container">resource</var>.</li>
                <li>If <var data-type="string">supplied_mime_type</var> is not equal to <code>application/miniapp-pkg+zip</code>, then return failure.</li>
                <li>Return <var data-type="MiniApp ZIP container">resource</var>.</li>
            </ol>
        </section>

        <section id="sec-miniapp-processing-verify">
            <h3 id="x5-2-miniapp-zip-container-verification"><bdi class="secno">5.2 </bdi>MiniApp ZIP Container Verification<a class="self-link" aria-label="§" href="#sec-miniapp-processing-verify"></a></h3>
            <p><a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-14">User agents</a> <em class="rfc2119">MAY</em> guarantee the legitimacy and integrity of the <a data-link-type="dfn" href="#dfn-container" class="internalDFN" id="ref-for-dfn-container-17">MiniApp ZIP container</a> and its content by verifying digital signatures and applying cryptographic mechanisms.</p>  
            <p>To <dfn data-lt="verifying a MiniApp ZIP container|Verify a MiniApp ZIP container|verify a MiniApp ZIP container" id="dfn-verifying-a-miniapp-zip-container" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">verify a MiniApp ZIP container</dfn>, given <a data-link-type="dfn" href="#dfn-container" class="internalDFN" id="ref-for-dfn-container-18">MiniApp ZIP container</a> <var data-type="MiniApp ZIP container">miniapp_zip_file</var>, perform the following steps:</p>
            <ol class="algorithm">
                <li>If the <a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-15">user agent</a> has the capability to perform digital signature(s) verification of <var data-type="MiniApp ZIP container">miniapp_zip_file</var>, then: <br>
                    <a data-link-type="dfn" href="#dfn-processing-the-digital-signatures" class="internalDFN" id="ref-for-dfn-processing-the-digital-signatures-2">Process the digital signatures</a> with <var data-type="MiniApp ZIP container">miniapp_zip_file</var>.
                </li>
            </ol>
            <section id="sec-miniapp-digital-signatures-processing">
                <h4 id="x5-2-1-digital-signatures-processing"><bdi class="secno">5.2.1 </bdi>Digital Signatures Processing<a class="self-link" aria-label="§" href="#sec-miniapp-digital-signatures-processing"></a></h4>
                <p>The <a data-link-type="dfn" href="#dfn-container" class="internalDFN" id="ref-for-dfn-container-19">MiniApp ZIP container</a> <em class="rfc2119">MAY</em> contain a <a data-link-type="dfn" href="#dfn-signing_block" class="internalDFN" id="ref-for-dfn-signing_block-6">signing block</a> that includes one or more signatures. The signing schemes and cryptographic mechanisms depend on the concrete implementation by <a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-16">user agents</a>.</p> 
                <p>Signing schemes are identified by the <a data-link-type="dfn" href="#dfn-magic-numbers" class="internalDFN" id="ref-for-dfn-magic-numbers-3">magic numbers</a> section included in the <a data-link-type="dfn" href="#dfn-container" class="internalDFN" id="ref-for-dfn-container-20">MiniApp ZIP container</a>, a 16-byte sequence located immediately before the Central Directory of the ZIP package.</p>
                <p>To <dfn data-lt="processing the digital signatures|Process the digital signatures|process the digital signatures" id="dfn-processing-the-digital-signatures" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">process the digital signatures</dfn>, given <a data-link-type="dfn" href="#dfn-container" class="internalDFN" id="ref-for-dfn-container-21">MiniApp ZIP container</a> <var data-type="MiniApp ZIP container">miniapp_zip_file</var>, perform the following steps:</p>
                <ol class="algorithm">
                    <li>Let <var data-type="byte sequence">magic_numbers</var> be a <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a>.</li>
                    <li>Let <var data-type="byte sequence">eocd_pointer</var> be a <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a> as the result of locating the byte sequence <code>0x06054b50</code> (read as little-endian) in <var data-type="MiniApp ZIP container">miniapp_zip_file</var> that marks the End of the Central Directory [<cite><a class="bibref" data-link-type="biblio" href="#bib-zip" title=".ZIP File Format Specification">ZIP</a></cite>].</li>
                    <li>Set <var data-type="byte sequence">eocd_pointer</var> to <var data-type="byte sequence">eocd_pointer</var> + 0x00000010.</li>
                    <li>Let <var data-type="byte sequence">cd_pointer</var> be the result of reading the 4-byte sequence at <var data-type="byte sequence">eocd_pointer</var>.</li>
                    <li>Let <var data-type="byte sequence">magic_numbers_pointer</var> be <var data-type="byte sequence">eocd_pointer</var> - 0x00000010.</li>
                    <li>Set <var data-type="byte sequence">magic_numbers</var> to the 16-byte block at <var data-type="byte sequence">magic_numbers_pointer</var>.</li>
                    <li>Process the digital signatures with <var data-type="byte sequence">magic_numbers</var> and <var data-type="MiniApp ZIP container">miniapp_zip_file</var>.</li>
                </ol>
                <div class="note" role="note" id="issue-container-generatedID-2"><div role="heading" class="note-title marker" id="h-note-0" aria-level="5"><span>Note</span><span class="issue-label">: Usage</span></div><div class="">
                    <a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-17">MiniApp user agents</a> implement specific digital signature processing algorithms based on their needs and requirements.  
                </div></div>
                <aside class="example" id="example-location-of-a-digital-signature-within-a-miniapp-package"><div class="marker">
    <a class="self-link" href="#example-location-of-a-digital-signature-within-a-miniapp-package">Example<bdi> 7</bdi></a><span class="example-title">: Location of a digital signature within a MiniApp package</span>
  </div>
                    <p>The <a data-link-type="dfn" href="#dfn-signing_block" class="internalDFN" id="ref-for-dfn-signing_block-7">MiniApp signing block</a> may be encoded using any digital signature scheme that is identified by the 16-byte <a data-link-type="dfn" href="#dfn-magic-numbers" class="internalDFN" id="ref-for-dfn-magic-numbers-4">magic numbers</a> block located just immediately before the Central Directory in the <a data-link-type="dfn" href="#dfn-container" class="internalDFN" id="ref-for-dfn-container-22">MiniApp ZIP container</a>. As shown in the example in <a href="#figure-miniapp-location-magic-numbers" class="fig-ref" title="Example of End of Central Directory signature, location of the Central Directory and signature magic numbers">Figure <bdi class="figno">3</bdi></a>, the End of Central Directory, identified by the values <code>0x06054b50</code>, contains the offset that enables <a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-18">user agents</a> to identify the start of the Central Directory block, and subsequently the magic numbers at the end of the <a data-link-type="dfn" href="#dfn-signing_block" class="internalDFN" id="ref-for-dfn-signing_block-8">signing block</a>.</p>
                    <figure id="figure-miniapp-location-magic-numbers">
                        <img src="images/signature_bytes_central_directory.svg" alt="Location of the magic numbers within the MiniApp package" height="273" width="538">
                        <figcaption>Figure <bdi class="figno">3</bdi> <span class="fig-title">Example of End of Central Directory signature, location of the Central Directory and signature magic numbers</span></figcaption>
                    </figure>
                </aside>
            </section>
        </section>

        <section id="sec-miniapp-processing-manifest">
            <h3 id="x5-3-miniapp-manifest-processing"><bdi class="secno">5.3 </bdi>MiniApp Manifest Processing<a class="self-link" aria-label="§" href="#sec-miniapp-processing-manifest"></a></h3>
            <p><a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-19">User agents</a> <em class="rfc2119">MUST</em> parse the <a href="https://www.w3.org/TR/miniapp-manifest/#dfn-miniapp-manifest-s" data-link-type="dfn">MiniApp manifest</a>, located in the <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-24">MiniApp package</a>, that contains global metadata about the MiniApp.</p>  
            <p>To <dfn data-lt="processing the MiniApp manifest|process the MiniApp manifest" id="dfn-processing-the-miniapp-manifest" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">process the MiniApp manifest</dfn>, given <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-25">MiniApp Package</a> <var data-type="MiniApp Package">miniapp_package</var>, perform the following steps. They return <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">ordered map</a>.</p>
            <ol class="algorithm">
                <li>If <code>manifest.json</code> file does not exist in the package's <a data-link-type="dfn" href="#dfn-root-directory" class="internalDFN" id="ref-for-dfn-root-directory-13">root directory</a>, then return failure.</li>
                <li>Let <var data-type="ordered map">manifest_json</var> be the result of <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#parse-json-bytes-to-a-javascript-value">parse JSON from bytes</a>, passing <code>manifest.json</code>.</li>
                <li>If <var data-type="ordered map">manifest_json</var> is a parsing exception, or <var data-type="ordered map">manifest_json</var> is not an <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">ordered map</a>, then return failure.</li>
                <li>Let <var data-type="ordered map">manifest</var> be an <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">ordered map</a>.</li>
                <li><a href="https://www.w3.org/TR/miniapp-manifest/#dfn-processing-a-miniapp-manifest" data-link-type="dfn">Process a MiniApp manifest</a>, passing <var data-type="ordered map">manifest_json</var> and <var data-type="ordered map">manifest</var>.</li>
                <li>Return <var data-type="ordered map">manifest</var>.</li>
            </ol>
        </section>

        <section id="sec-miniapp-platform-runtime-preparation">
            <h3 id="x5-4-platform-runtime-preparation"><bdi class="secno">5.4 </bdi>Platform Runtime Preparation<a class="self-link" aria-label="§" href="#sec-miniapp-platform-runtime-preparation"></a></h3>
            <p><a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-20">User agents</a> <em class="rfc2119">SHOULD</em> prepare the runtime environment that contains both the logic and the view layers. The logic layer is responsible for logic and control of the application (i.e., <code>app.js</code>, and <code>page.js</code> files). The view layer is responsible for the visual environment and rendering, including the page resource files, such as component templates and stylesheets. In preparation for running a MiniApp, <a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-21">user agents</a> <em class="rfc2119">MUST</em> set up the environment with the configuration specified by the <a href="https://www.w3.org/TR/miniapp-manifest/#dfn-miniapp-manifest-s" data-link-type="dfn">MiniApp manifest</a> metadata.</p>
            <p><a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-22">User agents</a> <em class="rfc2119">MUST</em> identify and load the <a data-link-type="dfn" href="#dfn-start-page" class="internalDFN" id="ref-for-dfn-start-page-2">start page</a> as the MiniApp entry point, according to the following algorithm.</p>
            <p>To <dfn data-lt="preparing the platform runtime|prepare the platform runtime" id="dfn-preparing-the-platform-runtime" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">prepare the platform runtime</dfn>, given <a data-link-type="dfn" data-type="dfn" href="https://url.spec.whatwg.org/#concept-url">URL</a> <var data-type="URL">miniapp_uri</var> and <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">ordered map</a> <var data-type="ordered map">manifest</var>, perform the following steps. They return a <a data-link-type="dfn" href="#dfn-start-page" class="internalDFN" id="ref-for-dfn-start-page-3">MiniApp start page</a>.</p>
            <ol class="algorithm">
                <li>If <code>app.js</code> does not exist in the <a data-link-type="dfn" href="#dfn-root-directory" class="internalDFN" id="ref-for-dfn-root-directory-14">root directory</a>, then return failure.</li>
                <li>If <code>app.css</code> does not exist in the <a data-link-type="dfn" href="#dfn-root-directory" class="internalDFN" id="ref-for-dfn-root-directory-15">root directory</a>, then return failure.</li>
                <li><a data-link-type="dfn" href="#dfn-verify-platform-compatibility" class="internalDFN" id="ref-for-dfn-verify-platform-compatibility-1">Verify platform compatibility</a>, passing <var>miniapp_package</var> and <var data-type="ordered map">manifest</var>.</li>
                <li>Let <var data-type="URL">start_page</var> be the result of <a data-link-type="dfn" href="#dfn-determining-the-start-page" class="internalDFN" id="ref-for-dfn-determining-the-start-page-1">determining the start page</a>, passing <var>miniapp_package</var>, <var data-type="URL">miniapp_uri</var> and <var data-type="ordered map">manifest</var>.</li>
                <li>Return <var data-type="URL">miniapp_uri</var>.</li>
            </ol>
            <section id="sec-miniapp-platform-compatibility-verification">
                <h4 id="x5-4-1-platform-compatibility-verification"><bdi class="secno">5.4.1 </bdi>Platform Compatibility Verification<a class="self-link" aria-label="§" href="#sec-miniapp-platform-compatibility-verification"></a></h4>
                <p><a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-23">User agents</a> <em class="rfc2119">MUST</em> verify that a <a data-link-type="dfn" href="#dfn-miniapp" class="internalDFN" id="ref-for-dfn-miniapp-2">MiniApp</a> is compatible with them and can run properly in their platform. This verification is performed using the metadata specified in the <a href="https://www.w3.org/TR/miniapp-manifest/#dfn-miniapp-manifest-s" data-link-type="dfn">MiniApp manifest</a>, including the supported version of the platform and checking the pages and resources needed in the execution.</p>
                <p>To <dfn data-lt="Verify platform compatibility|verify platform compatibility" id="dfn-verify-platform-compatibility" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">verify platform compatibility</dfn>, given <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-26">MiniApp Package</a> <var data-type="MiniApp Package">miniapp_package</var> and <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">ordered map</a> <var data-type="ordered map">manifest</var>, perform the following steps:</p>
                <ol class="algorithm">
                    <li>Set <var data-type="ordered map">platform_required</var> to <var data-type="ordered map">manifest</var>["platform_version"].</li>
                    <li>If <var data-type="ordered map">platform_required</var> is not compatible with the <a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-24">user agent</a> configuration, then return failure.</li>
                    <li><a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate">For each</a> <var data-type="URL">page</var> of <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#list">list</a> <var data-type="ordered map">manifest</var>["pages"]:
                        <ol>
                            <li>If <var data-type="URL">page</var> does not exist in the <var data-type="MiniApp Package">miniapp_package</var>, return failure.</li>
                        </ol>
                    </li>
                    <li>If <var data-type="ordered map">manifest</var>["widgets"] <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#map-exists">exists</a>, then:<br>
                        <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate">For each</a> <var data-type="URL">widget_path</var> of <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#list">list</a> <var data-type="ordered map">manifest</var>["widgets"]:
                        <ol>
                            <li>If <var data-type="URL">widget_path</var> does not exist in the <var data-type="MiniApp Package">miniapp_package</var>, return failure.</li>
                        </ol>
                    </li>
                </ol>                
            </section>
            <section id="sec-miniapp-platform-start-page-identification">
                <h4 id="x5-4-2-start-page-identification"><bdi class="secno">5.4.2 </bdi>Start Page Identification<a class="self-link" aria-label="§" href="#sec-miniapp-platform-start-page-identification"></a></h4>
                <p>By default, <a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-25">user agents</a> <em class="rfc2119">MUST</em> load the <a data-link-type="dfn" href="#dfn-start-page" class="internalDFN" id="ref-for-dfn-start-page-4">start page</a> indicated in the <a href="https://www.w3.org/TR/miniapp-manifest/#dfn-miniapp-manifest-s" data-link-type="dfn">MiniApp manifest</a> as the entry point when the MiniApp <a href="sec-miniapp-processing-execute">is launched</a>. This <a data-link-type="dfn" href="#dfn-start-page" class="internalDFN" id="ref-for-dfn-start-page-5">start page</a> by default <em class="rfc2119">MUST</em> be overridden if a valid <a data-link-type="dfn" href="#dfn-page" class="internalDFN" id="ref-for-dfn-page-24">page</a> is specified in the MiniApp URI, as specified in the following algorithm.</p>
                <p>To <dfn data-lt="determining the start page|determine the start page" id="dfn-determining-the-start-page" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">determine the start page</dfn>, given <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-27">MiniApp Package</a> <var data-type="MiniApp Package">miniapp_package</var>, <a data-link-type="dfn" data-type="dfn" href="https://url.spec.whatwg.org/#concept-url">URL</a> <var data-type="URL">miniapp_uri</var>, and <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">ordered map</a> <var data-type="ordered map">manifest</var>, perform the following steps. They return a <a data-link-type="dfn" data-type="dfn" href="https://url.spec.whatwg.org/#concept-url">URL</a>.</p>
                <ol class="algorithm">
                    <li>Let <var data-type="URL">start_page</var> be the result of <a data-link-type="dfn" href="#dfn-extracting-the-start-page-from-uri" class="internalDFN" id="ref-for-dfn-extracting-the-start-page-from-uri-1">extracting the start page from URI</a>, passing <var data-type="URL">miniapp_uri</var>.</li>
                    <li>If <var data-type="URL">start_page</var> is not set, or if <var data-type="URL">start_page</var> is equal to null, or if <var data-type="URL">start_page</var> does not exist in <var data-type="MiniApp Package">miniapp_package</var>, then:<br>
                        Set <var data-type="URL">start_page</var> to the result of <a data-link-type="dfn" href="#dfn-extracting-the-start-page-from-manifest" class="internalDFN" id="ref-for-dfn-extracting-the-start-page-from-manifest-1">extracting the start page from manifest</a>, passing <var data-type="ordered map">manifest</var>.
                    </li>
                    <li>Return <var data-type="URL">start_page</var></li>
                </ol>  
                <section id="sec-miniapp-processing-platform-start-page-uri">
                    <h5 id="x5-4-2-1-extraction-of-start-page-from-uri"><bdi class="secno">5.4.2.1 </bdi>Extraction of Start Page From URI<a class="self-link" aria-label="§" href="#sec-miniapp-processing-platform-start-page-uri"></a></h5>
                    <p>MiniApp URIs <em class="rfc2119">MAY</em> contain information about the <a data-link-type="dfn" href="#dfn-start-page" class="internalDFN" id="ref-for-dfn-start-page-6">start page</a>, specified as the <a data-link-type="dfn" data-type="dfn" href="https://url.spec.whatwg.org/#url-path-segment-string">URL-path-segment string</a> of the URI.</p>
                    <p>To <dfn data-lt="extracting the start page from URI|extract the start page from URI" id="dfn-extracting-the-start-page-from-uri" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">extract the start page from URI</dfn>, given <a data-link-type="dfn" data-type="dfn" href="https://url.spec.whatwg.org/#concept-url">URL</a> <var data-type="URL">miniapp_uri</var>, perform the following steps. They return a <a data-link-type="dfn" data-type="dfn" href="https://url.spec.whatwg.org/#concept-url">URL</a>.</p>
                    <ol class="algorithm">
                        <li>Let <var data-type="URL">start_page</var> be the <a data-link-type="dfn" data-type="dfn" href="https://url.spec.whatwg.org/#url-path-segment-string">URL-path-segment string</a> resulting of <a data-link-type="dfn" data-lt="URL Parser" data-type="dfn" href="https://url.spec.whatwg.org/#concept-url-parser">parse</a> <var data-type="URL">miniapp_uri</var>.</li>
                        <li>If <var data-type="URL">start_page</var> is failure, return null.</li> 
                        <li>Return <var data-type="URL">start_page</var>.</li>
                    </ol>                     
                </section>
                <section id="sec-miniapp-processing-platform-start-page-manifest">
                    <h5 id="x5-4-2-2-extraction-of-start-page-from-manifest"><bdi class="secno">5.4.2.2 </bdi>Extraction of Start Page From Manifest<a class="self-link" aria-label="§" href="#sec-miniapp-processing-platform-start-page-manifest"></a></h5>
                    <p>As described in the <a href="https://www.w3.org/TR/miniapp-manifest/#pages-member">MiniApp Manifest's <code>pages</code> member</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-miniapp-manifest" title="MiniApp Manifest">MINIAPP-MANIFEST</a></cite>], the <a data-link-type="dfn" href="#dfn-start-page" class="internalDFN" id="ref-for-dfn-start-page-7">start page</a> of a MiniApp is specified in the first item of the <code>pages</code> <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#list">list</a>.</p>
                    <p>To <dfn data-lt="extracting the start page from manifest|extract the start page from manifest" id="dfn-extracting-the-start-page-from-manifest" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">extract the start page from manifest</dfn>, given <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">ordered map</a> <var data-type="ordered map">manifest</var>, perform the following steps. They return a <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#string">string</a>.</p>
                    <ol class="algorithm">
                        <li>Let <var>start_page_id</var> be the empty <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#string">string</a>.</li>
                        <li>Let <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#list">list</a> <var data-type="list">pages</var> be <var data-type="ordered map">manifest</var>["pages"].</li>
                        <li>Return <var data-type="list">pages</var>[0].</li>
                    </ol>
                </section>
            </section>
            <section id="sec-miniapp-processing-locale">
                <h4 id="x5-4-3-extraction-of-locale"><bdi class="secno">5.4.3 </bdi>Extraction of Locale<a class="self-link" aria-label="§" href="#sec-miniapp-processing-locale"></a></h4>
                <p>To <dfn data-lt="extracting the locale|extract the locale" id="dfn-extracting-the-locale" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">extract the locale</dfn>, given <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">ordered map</a> <var data-type="ordered map">manifest</var>, perform the following steps. They return a <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#string">string</a>.</p>
                <ol class="algorithm">
                    <li>Let <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#string">string</a> <var data-type="string">locale</var> be the <a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-26">user agent</a>'s default locale.</li>
                    <li>If <var data-type="ordered map">manifest</var>["lang"] <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#map-exists">exists</a>, and if <var data-type="ordered map">manifest</var>["lang"] is supported by the <a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-27">user agent</a>, then: <br>
                        Set <var data-type="string">locale</var> to <var data-type="ordered map">manifest</var>["lang"].
                    </li><li>Return <var data-type="string">locale</var>.</li>
                </ol>
            </section>                
        </section>
    </section>         
    <section id="sec-security-privacy">
        <h2 id="x6-security-and-privacy-considerations"><bdi class="secno">6. </bdi>Security and Privacy Considerations<a class="self-link" aria-label="§" href="#sec-security-privacy"></a></h2>
        <section id="package-integrity-and-trustworthiness">
            <h3 id="x6-1-package-integrity-and-trustworthiness"><bdi class="secno">6.1 </bdi>Package Integrity and Trustworthiness<a class="self-link" aria-label="§" href="#package-integrity-and-trustworthiness"></a></h3>
            <p>To ensure the integrity and trustworthiness within the distribution stage of MiniApps, a <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-28">MiniApp package</a> <em class="rfc2119">SHOULD</em> be protected by one or more <a data-link-type="dfn" href="#dfn-signature" class="internalDFN" id="ref-for-dfn-signature-3">digital signatures</a>. These signatures, along with certificates issued by trusted authorities, could help third parties to validate the authorship of the MiniApp (e.g. the MiniApp developer), and other entities involved in the development or distribution of the software (e.g., an application store as MiniApp distributor).</p>
            <p>The usual scenarios where digital signatures are included in MiniApps are, but not limited to:</p> 
            <ul>  
                <li>A digital signature (with a valid certificate) of the author that ensures the origin of the MiniApp, which gives a recipient strong reason to believe that this package was created by a known sender (authentication) and that the message was not altered in transit (integrity). Thus, an end-user or a hosting platform can decide whether to install the <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-29">MiniApp package</a> depending on the status and quality of the author (e.g., credits, blocklist, certifications, etc.).</li>
                <li>Distributors’ signatures (for example, official marketplace signatures), which are used to ensure the trustworthiness of the delivery channel. This kind of signature protects end-users from tampering activities and ensures a healthy ecosystem of applications. </li>
            </ul>
            <p>No specific digital signature mechanism, cryptographic technology, or algorithm is recommended in this specification. MiniApp vendors <em class="rfc2119">MAY</em> or <em class="rfc2119">MAY</em> NOT implement digital signature mechanisms, according to their use cases. When implemented, the <a href="#sec-miniapp-digital-signature-requirements" class="sec-ref">§&nbsp;<bdi class="secno">3.3 </bdi>Digital Signature Requirements</a> shall be followed.</p>

            <p>Some examples of technologies and encryption methods are introduced in the <a href="#sec-signature-schemes" class="sec-ref">§&nbsp;<bdi class="secno">B. </bdi>Signature Schemes</a>.</p>

        </section>
        <section id="content-confidentiality">
            <h3 id="x6-2-content-confidentiality"><bdi class="secno">6.2 </bdi>Content Confidentiality<a class="self-link" aria-label="§" href="#content-confidentiality"></a></h3>
            <p>This specification does not recommend any encryption mechanism for the <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-30">MiniApp package</a> to protect its confidentiality. However, it doesn't preclude an implementation from deploying some encryption mechanism for special purposes.</p>
        </section>
    </section>    

    <section class="appendix informative" id="sec-acknowledgments">
        <h2 id="a-acknowledgments"><bdi class="secno">A. </bdi>Acknowledgments<a class="self-link" aria-label="§" href="#sec-acknowledgments"></a></h2><p><em>This section is non-normative.</em></p>
		<div class="note" id="issue-container-generatedID-3"><div role="heading" class="ednote-title marker" id="h-ednote-1" aria-level="3"><span>Editor's note</span></div><div class="">List all the contributors and <abbr title="World Wide Web Consortium">W3C</abbr> Team contacts</div></div>
    </section>
    <section class="appendix informative" id="sec-signature-schemes">
        <h2 id="b-signature-schemes"><bdi class="secno">B. </bdi>Signature Schemes<a class="self-link" aria-label="§" href="#sec-signature-schemes"></a></h2><p><em>This section is non-normative.</em></p>

        <p>Every <a data-link-type="dfn" href="#dfn-useragent" class="internalDFN" id="ref-for-dfn-useragent-28">user agent</a> <em class="rfc2119">MAY</em> support its own digital signature schemes depending on their needs. This section includes some examples of digital signature implementations as illustrated in <a href="#figure-miniapp-signatures-example" class="fig-ref" title="Example of different signature methods included in the MiniApp package">Figure <bdi class="figno">4</bdi></a>. They can be used in specific scenarios, such as developer verification and integrity of a MiniApp during its distribution.</p>   

                  
            <figure id="figure-miniapp-signatures-example">
                <img src="images/signature_zip_example.svg" alt="Example of signing blocks with different signature scheme in the MiniApp package" height="1304" width="2266">
                <figcaption>Figure <bdi class="figno">4</bdi> <span class="fig-title">Example of different signature methods included in the MiniApp package</span></figcaption>
            </figure>

        <section id="sec-signature-rpk">
            <h3 id="b-1-rpk-signature-scheme"><bdi class="secno">B.1 </bdi>RPK Signature Scheme<a class="self-link" aria-label="§" href="#sec-signature-rpk"></a></h3>
            <p>As one implementation of MiniApp, <a href="https://www.quickapp.cn/" hreflang="zh">Quick Apps</a> use a so-called RPK (Runnable Package) Signature Scheme, which is similar to the APK Signature Scheme v2 [<cite><a class="bibref" data-link-type="biblio" href="#bib-apk-signature-v2" title="APK Signature Scheme v2">APK-SIGNATURE-V2</a></cite>], to verify the authorship of the <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-31">MiniApp package</a>. This signature scheme takes every byte in a MiniApp package into the signature generation. The resulting <a data-link-type="dfn" href="#dfn-signing_block" class="internalDFN" id="ref-for-dfn-signing_block-9">signing block</a> is created and inserted into the package file, according to the <a href="#sec-miniapp-digital-signature-requirements">Digital Signature Requirements</a>.</p>
            <p>The <a data-link-type="dfn" href="#dfn-signing_block" class="internalDFN" id="ref-for-dfn-signing_block-10">signing block</a> contains ID-value pairs with information about the signature and the signer identity.</p> 
          
             <div class="note" role="note" id="issue-container-generatedID-4"><div role="heading" class="note-title marker" id="h-note-1" aria-level="4"><span>Note</span></div><p class="">All data values in the RPK <a data-link-type="dfn" href="#dfn-signing_block" class="internalDFN" id="ref-for-dfn-signing_block-11">signing block</a> are represented in little-endian format, and all length-prefixed fields use <code>uint32</code> for length.</p></div>
            
            <p>The description  uses the following basic data types:</p>
            <dl>
                <dt>uint64</dt>
                <dd>64-bit (8-byte) unsigned integer in little-endian format</dd>
                <dt>uint32</dt>
                <dd>32-bit (4-byte) unsigned integer in little-endian format</dd>
            </dl>

            <h4 id="signing-block-format">Signing Block Format<a class="self-link" aria-label="§" href="#sec-signature-rpk"></a></h4>
            <p>The format of the RPK signing block is as follows:</p>
            <ul>
                <li><strong>block size</strong> in bytes, excluding this field (uint64)</li>
                <li>Sequence of ID-value pairs (where the <a href="#sec-signing-block-signature">Signatures</a> are defined):
                    <ul>
                        <li><strong>size</strong> of ID-value pair (uint64)</li> 
                        <li><strong>ID</strong> (uint32)</li>
                        <li><strong>value</strong> (size of ID-value pair - 4 bytes)</li>
                    </ul>
                </li>
                <li><strong>block size</strong> in bytes (the same as first field) (uint64)</li>
                <li><strong>magic numbers</strong> “<code>RPK Sig Block 42</code>” (16 bytes)</li>
            </ul>

            <p>ID-value pairs with unknown IDs should be ignored when interpreting the block.</p>
            <p>The "block size" value enables locating the start of the signing block in the whole ZIP file.</p>
                
            <section id="sec-signing-block-signature">
                <h4 id="b-1-1-signatures"><bdi class="secno">B.1.1 </bdi>Signatures<a class="self-link" aria-label="§" href="#sec-signing-block-signature"></a></h4>
                <p>The signatures are stored as <strong>ID-value pairs</strong> with specific identifiers that represent the types of the signature. The supported signatures, and associated IDs, for RPK packages are described in the following sub-clauses.</p>
                
                <div class="note" id="issue-container-generatedID-5"><div role="heading" class="ednote-title marker" id="h-ednote-2" aria-level="5"><span>Editor's note</span><span class="issue-label">: package-splitting</span></div><p class=""> There are cases where a MiniApp package is split into multiple sub-packages (by a distribution platform e.g. an app-store) for the user agent to download and execute it in a progressive fashion to improve the user experience. In such a case, additional signature types (thus IDs) would be needed to ensure the integrity of each sub-package as well as the whole. Details are for further study.</p></div>
                <section id="developer-signature">
                    <h5 id="b-1-1-1-developer-signature"><bdi class="secno">B.1.1.1 </bdi>Developer Signature<a class="self-link" aria-label="§" href="#developer-signature"></a></h5>
                    <p>The ID-value pair in the signing block under ID <code>0x01000101</code> represents the data of the signature of the whole-file <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-32">MiniApp package</a>.</p>
                    <p>The value of the ID-pair contains all the signature blocks and it has a variable length and its structure is as follows:</p>
                    <ul>
                        <li><strong>ID</strong>: <code>0x01000101</code> (uint32)</li>
                        <li><strong>value</strong>:
                            <ul>
                                <li><strong>size</strong> of signer blocks, excluding this field (uint32)</li>
                                <li>Sequence of <strong>signer blocks</strong>:
                                    <ul>
                                        <li><strong>size</strong> of signer block, excluding this field (uint32)</li>
                                        <li><strong>signed data</strong>:
                                            <ul>
                                                <li><strong>size</strong> of digests, excluding this field (uint32)</li>
                                                <li>Sequence of <strong>digests</strong>:
                                                    <ul>
                                                        <li><strong>size</strong> of digest block, excluding this field (uint32)</li>                                                
                                                        <li><strong>signature algorithm ID</strong> (uint32)</li>
                                                        <li><strong>size</strong> of digest content, excluding this field (uint32)</li>                                                
                                                        <li><strong>digest</strong> content (variable length)</li>
                                                    </ul>
                                                </li>
                                                <li><strong>size of certificates</strong>, excluding this field (uint32)</li>
                                                <li>Sequence of <strong>certificates</strong>:
                                                    <ul>
                                                        <li><strong>size</strong> of certificate, excluding this field (uint32)</li>
                                                        <li><strong>X.509 certificate</strong> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2528" title="Internet X.509 Public Key Infrastructure Representation of Key Exchange Algorithm (KEA) Keys in Internet X.509 Public Key Infrastructure Certificates">rfc2528</a></cite>] in <abbr title="Abstract Syntax Notation One">ASN.1</abbr> <abbr title="Distinguished Encoding Rules">DER</abbr> form [<cite><a class="bibref" data-link-type="biblio" href="#bib-x690" title="Recommendation X.690 — Information Technology — ASN.1 Encoding Rules — Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER), and Distinguished Encoding Rules (DER)">X690</a></cite>] (variable length)</li>
                                                    </ul>
                                                </li>
                                                <li><strong>size</strong> of additional attributes, excluding this field (uint32)</li>                                                        
                                                <li><strong>additional attributes</strong></li>
                                            </ul>
                                        </li><li><strong>size</strong> of signatures, excluding this field (uint32)</li>
                                        <li>Sequence of <strong>signatures</strong>:
                                            <ul>
                                                <li><strong>size</strong> of signature, excluding this field (uint32)</li>
                                                <li><strong>signature algorithm ID</strong> (uint32)</li>
                                                <li><strong>size</strong> of signature content, excluding this field (uint32)</li>
                                                <li><strong>signature content</strong> (variable length)</li>
                                            </ul>
                                        </li><li><strong>size</strong> of public key, excluding this field (uint32)</li>                                                    
                                        <li><strong>public key</strong> in <abbr title="Abstract Syntax Notation One">ASN.1</abbr> <abbr title="Distinguished Encoding Rules">DER</abbr> [<cite><a class="bibref" data-link-type="biblio" href="#bib-x690" title="Recommendation X.690 — Information Technology — ASN.1 Encoding Rules — Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER), and Distinguished Encoding Rules (DER)">X690</a></cite>] form (variable length)</li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </section>
                <section id="distributor-signature">
                    <h5 id="b-1-1-2-distributor-signature"><bdi class="secno">B.1.1.2 </bdi>Distributor Signature<a class="self-link" aria-label="§" href="#distributor-signature"></a></h5>
                    <p>The signature of the distributor preserves the integrity of the application during the distribution process, guaranteeing that the package is verified by the trusted distributor and the permission control policy (in the form of a <dfn id="dfn-provisioning-profile" data-dfn-type="dfn" tabindex="0" aria-haspopup="dialog">provisioning profile</dfn>) from the distributor is enforced upon the package.</p>

                    <p>During the process of distributor signing, either the distributor or the developer adds a <a data-link-type="dfn" href="#dfn-provisioning-profile" class="internalDFN" id="ref-for-dfn-provisioning-profile-1">Provisioning Profile</a> and uses the private key of the distributor to sign the signature.</p>
                    <p>The <a data-link-type="dfn" href="#dfn-provisioning-profile" class="internalDFN" id="ref-for-dfn-provisioning-profile-2">Provisioning Profile</a> is stored in the ID-value pair of the signing block under ID <code>0x02000201</code>.</p>
                    <p>The value of the ID-pair contains all its signature blocks and it has a variable length and its structure is as follows:</p>
                    <ul>
                        <li><strong>ID</strong>: <code>0x02000201</code> (uint32)</li>
                        <li><strong>value</strong>:
                            <ul>
                                <li><strong>size</strong> of signer block, excluding this field (uint32)</li>
                                <li><strong>signer block</strong>:
                                    <ul>
                                        <li><strong>size</strong> of the <a data-link-type="dfn" href="#dfn-provisioning-profile" class="internalDFN" id="ref-for-dfn-provisioning-profile-3">Provisioning Profile</a>, excluding this field (uint32)</li>
                                        <li><strong>provisioning profile</strong>. Sequence of the provisioning profile ID-value pairs, according to the <a href="#sec-provisioning-profile-id">provisioning profile IDs</a>:
                                            <ul>
                                                <li><strong>size</strong> of ID-value pair, excluding this field (uint32)</li>
                                                <li><strong>ID</strong> (uint32)</li>
                                                <li><strong>value</strong> (variable length)</li>
                                            </ul>
                                        </li>
                                        <li><strong>size</strong> of signature, excluding this field (uint32)</li>
                                        <li><strong>signature algorithm ID</strong> according to the values of <a href="#sec-signature-algorithm-id">Signature Algorithm IDs</a> (uint32)</li>
                                        <li><strong>size</strong> of signature content, excluding this field (uint32)</li>
                                        <li><strong>signature content</strong> (variable length)</li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                    </ul>
                    <h6 id="sec-signature-algorithm-id">Signature Algorithm IDs<a class="self-link" aria-label="§" href="#sec-signature-algorithm-id"></a></h6>
                    <ul>
                        <li><code>0x0101</code> RSASSA-PSS with SHA2-256 digest, SHA2-256 MGF1, 32 bytes of salt, trailer: 0xbc</li>
                        <li><code>0x0102</code> RSASSA-PSS with SHA2-512 digest, SHA2-512 MGF1, 64 bytes of salt, trailer: 0xbc</li>
                        <li><code>0x0103</code> RSASSA-PKCS1-v1_5 with SHA2-256 digest. This is for build systems which require deterministic signatures.</li>
                        <li><code>0x0104</code> RSASSA-PKCS1-v1_5 with SHA2-512 digest. This is for build systems which require deterministic signatures.</li>
                        <li><code>0x0201</code> ECDSA with SHA2-256 digest</li>
                        <li><code>0x0202</code> ECDSA with SHA2-512 digest</li>
                        <li><code>0x0301</code> DSA with SHA2-256 digest</li>
                    </ul>
                    <h6 id="sec-signature-key-sizes">Supported keys sizes and <abbr title="elliptic-curve">EC</abbr> cryptography:<a class="self-link" aria-label="§" href="#sec-signature-key-sizes"></a></h6>
                    <ul>
                        <li><strong>RSA</strong>: 1024, 2048, 4096, 8192, 16384</li>
                        <li><strong><abbr title="elliptic-curve">EC</abbr></strong>: NIST P-256, P-384, P-521</li>
                        <li><strong>DSA</strong>: 1024, 2048, 3072</li>
                    </ul>
                    <h6 id="sec-provisioning-profile-id">Provisioning Profile IDs<a class="self-link" aria-label="§" href="#sec-provisioning-profile-id"></a></h6>
                    <ul>
                        <li><code>0x01</code> Certificate Digest
                            <ul>
                                <li><strong>size</strong> of certificate digest block, excluding this field (uint32)</li>
                                <li><strong>signature algorithm ID</strong> according to the values of <a href="#sec-signature-algorithm-id">Signature Algorithm IDs</a> (uint32)</li>
                                <li><strong>size</strong> of certificate digest data, excluding this field (uint32)</li>
                                <li><strong>certificate digest data</strong> (variable length)</li>
                            </ul>
                        </li>
                        <li><code>0x02</code> Certificate
                            <ul>
                                <li><strong>size</strong> of certificate, excluding this field (uint32)</li>
                                <li><strong>certificate data</strong> in <abbr title="Abstract Syntax Notation One">ASN.1</abbr> <abbr title="Distinguished Encoding Rules">DER</abbr> [<cite><a class="bibref" data-link-type="biblio" href="#bib-x690" title="Recommendation X.690 — Information Technology — ASN.1 Encoding Rules — Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER), and Distinguished Encoding Rules (DER)">X690</a></cite>] form (variable length)</li>
                            </ul>
                        </li>
                        <li><code>0x03</code> Usage:
                            <ul>
                                <li><strong>app store</strong>, value: <code>0x01</code></li>
                                <li><strong>debug</strong>, value: <code>0x02</code></li>
                                <li><strong>enterprise</strong>, value: <code>0x03</code></li>
                            </ul>
                        </li>
                        <li><code>0x04</code> Manifest
                            <ul>
                                <li><strong>size</strong> of manifest, excluding this field (uint32)</li>
                                <li><strong>manifest</strong> in UTF-8 [<cite><a class="bibref" data-link-type="biblio" href="#bib-unicode" title="The Unicode Standard">UNICODE</a></cite>] (variable length)</li>
                            </ul>
                        </li>
                        <li><code>0x05</code> Device IDs
                            <ul>
                                <li><strong>size</strong> of Device IDs, excluding this field (uint32)</li>
                                <li>Sequence of <strong>Device IDs</strong>:
                                    <ul>
                                        <li><strong>size</strong> of Device ID, excluding this field (uint32)</li>
                                        <li><strong>Device ID</strong>, represented in MD5 format [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc1321" title="The MD5 Message-Digest Algorithm">rfc1321</a></cite>] (variable length)</li> 
                                    </ul>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </section>            
            </section>
        </section>
        <section id="sec-signature-pkcs7">
            <h3 id="b-2-pkcs-7-signature-scheme"><bdi class="secno">B.2 </bdi>PKCS#7 Signature Scheme<a class="self-link" aria-label="§" href="#sec-signature-pkcs7"></a></h3>
            <p>This signature scheme is based on the PKCS #7 Cryptographic Message Syntax [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2315" title="PKCS #7: Cryptographic Message Syntax Version 1.5">rfc2315</a></cite>]. It <em class="rfc2119">MAY</em> cover different stages of packaging signature described in <a href="#sec-signature-rpk">RPK Signature Scheme</a>, including the developer signature and distributor signature.</p>
            <p>This signature scheme includes the <a data-link-type="dfn" href="#dfn-provisioning-profile" class="internalDFN" id="ref-for-dfn-provisioning-profile-4">Provisioning Profile</a> of the MiniApp and the developer's signature at the first stage (developer signing stage). At the second stage (distributor signing stage), a distributor <em class="rfc2119">MAY</em> replace the developer's signature with the its own signature. Like the <a href="#sec-signature-rpk">RPK Signature Scheme</a>, this approach generates a signing block to be included into the package file, according to the <a href="#sec-miniapp-digital-signature-requirements">Digital Signature Requirements</a>.</p>

            <p>The PKCS#7 signing block is defined as a data container that includes the block with the digital signature, data encrypted using the PKCS #7 syntax that contains the signatures and the signer identity.</p>
    
            
            <p>The description  uses the following basic data types:</p>
            <dl>
                <dt>uint64</dt>
                <dd>64-bit (8-byte) unsigned integer</dd>
                <dt>uint32</dt>
                <dd>32-bit (4-byte) unsigned integer</dd>
                <dt>uint16</dt>
                <dd>16-bit (2-byte) unsigned integer</dd>
            </dl>

            <h4 id="signing-block-format-0">Signing Block Format<a class="self-link" aria-label="§" href="#sec-signature-pkcs7"></a></h4>
            <p>The format of the PKCS#7 signing block is as follows:</p>
            <ul>
                <li id="pkcs7-profile-block-head"><strong>Signing block head</strong>
                    <ul>
                        <li><strong>type</strong> to indicate the type, according to <a href="#types-signing-blocks">Types of signing blocks</a> (1 byte)</li>
                        <li><strong>tag</strong> to indicate the sub-type, according to <a href="#types-signing-blocks">Types of signing blocks</a> (1 byte)</li>
                        <li><strong>length</strong> (uint16)</li>
                        <li><strong>offset</strong> (uint32)</li>
                    </ul>                    
                </li>
                <li>Signature Block head:
                    <ul>
                        <li><strong>reserved</strong> (4 bytes)</li>
                        <li><strong>number of blocks</strong> (uint32)</li>
                        <li><strong>size</strong> (uint32)</li>
                        <li><strong>version</strong> (4 bytes)</li>
                        <li><strong>magic numbers</strong> “<code>MIX Sig Block 42</code>” (16 bytes)</li>
                    </ul>
                </li>
                <li><strong>Data</strong></li>
                <li><strong>Signature Block data</strong> in PKCS #7:
                    <ul>
                        <li>PKCS #7 Content Type set to <code>SignedData</code>:
                            <ul>
                                <li><strong>version</strong>: syntax version number</li>
                                <li><strong>digest algorithms</strong>: a collection of message-digest algorithm identifiers</li>
                                <li>The content that is signed:
                                    <ul>
                                        <li><strong>version</strong> (uint32)</li>
                                        <li><strong>size</strong> (uint16)</li>
                                        <li><strong>number of blocks</strong> (uint16)</li>
                                        <li><strong>Content Hash</strong>:
                                            <ul>
                                                <li><strong>type</strong> (uint8)</li>
                                                <li><strong>tag</strong> (uint8)</li>
                                                <li><strong>algorithm ID</strong> (uint8)</li>
                                                <li><strong>length</strong> (uint32)</li>
                                                <li><strong>hash</strong> (variable length)</li>
                                            </ul>  
                                        </li>
                                    </ul> 
                                </li>
                                <li><strong>certificates</strong>: a set of PKCS #6 extended certificates and X.509 certificates</li>
                                <li><strong>crls</strong>: a set of certificate-revocation lists</li>
                                <li><strong>signerInfos</strong>: a collection of per-signer information</li>
                            </ul>
                        </li>
                        <li>Signer</li>
                    </ul>
                </li>
                <li>Hw sign head:
                    <ul>
                        <li><strong>number of blocks</strong> (uint32)</li>
                        <li><strong>size</strong> (uint32)</li>
                        <li><strong>version</strong> (4 bytes)</li>
                        <li><strong>magic numbers</strong> “<code>MIX Sig Block 42</code>” (16 bytes)</li>
                    </ul>
                </li>
            </ul>

            <h5 id="types-signing-blocks">Types of Signing Blocks<a class="self-link" aria-label="§" href="#types-signing-blocks"></a></h5>
            <p>The type of the <a href="#pkcs7-profile-block-head">Block Head</a> is identified by its attribute <code>type</code>. This attribute <em class="rfc2119">MUST</em> take two different values:</p>
            <ul>
                <li><code>0</code> for File Signature blocks</li>
                <li><code>1</code> for <a data-link-type="dfn" href="#dfn-provisioning-profile" class="internalDFN" id="ref-for-dfn-provisioning-profile-5">Provisioning Profile</a> blocks</li>
            </ul>
            <p>If the value of type is set to <code>0</code> (File Signature block), the header <em class="rfc2119">MUST</em> specify a narrower subtype, using the attribute <code>tag</code> in its <a href="#pkcs7-profile-block-head">Block Head</a>. The values for this subtype are:</p>
            <ul>
                <li><code>0</code>: Default</li>
                <li><code>1</code>: HASH (Whole file hash)</li> 
                <li><code>0x80</code>: 1M_HASH_ROOT (1M block hash tree, root hash)</li>
                <li><code>0x81</code>: 512K_HASH_ROOT (512K block hash tree, root hash)</li>
                <li><code>0x82</code>: 256K_HASH_ROOT (256K block hash tree, root hash)</li>
                <li><code>0x83</code>: 128K_HASH_ROOT (128K block hash tree, root hash)</li>
                <li><code>0x84</code>: 64K_HASH_ROOT (64K block hash tree, root hash)</li>
                <li><code>0x85</code>: 32K_HASH_ROOT (32K block hash tree, root hash)</li>
                <li><code>0x86</code>: 16K_HASH_ROOT (16K block hash tree, root hash)</li>	
                <li><code>0x87</code>: 8K_HASH_ROOT (8K block hash tree, root hash)</li>
                <li><code>0x88</code>: 4K_HASH_ROOT (4K block hash tree, root hash)</li>
                <li><code>0x90</code>: 1M_HASH_BLOCK (1M block hash tree)</li>
                <li><code>0x91</code>: 512K_HASH_BLOCK (512K block hash tree)</li>
                <li><code>0x92</code>: 256K_HASH_BLOCK (256K block hash tree)</li>
                <li><code>0x93</code>: 128K_HASH_BLOCK (128K block hash tree)</li>	
                <li><code>0x94</code>: 64K_HASH_BLOCK (64K block hash tree)</li>	
                <li><code>0x95</code>: 32K_HASH_BLOCK (32K block hash tree)</li>
                <li><code>0x96</code>: 16K_HASH_BLOCK (16K block hash tree)</li>	
                <li><code>0x97</code>: 8K_HASH_BLOCK (8K block hash tree)</li>
                <li><code>0x98</code>: 4K_HASH_BLOCK (4K block hash tree)</li>                
            </ul>
        </section>            
    </section>

<section class="appendix informative" id="sec-media-type-registration">
        <h2 id="c-media-type-registration"><bdi class="secno">C. </bdi>Media Type Registration<a class="self-link" aria-label="§" href="#sec-media-type-registration"></a></h2><p><em>This section is non-normative.</em></p>
        <p>This appendix registers the <code>application/miniapp-pkg+zip</code> media type for MiniApp packages, in conformance with BCP 13 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc4289" title="Multipurpose Internet Mail Extensions (MIME) Part Four: Registration Procedures">RFC4289</a></cite>] and <a href="https://www.w3.org/2020/01/registering-mediatypes.html">Register an Internet Media Type for a <abbr title="World Wide Web Consortium">W3C</abbr> Spec</a>.</p>

        <p>A <a data-link-type="dfn" href="#dfn-package" class="internalDFN" id="ref-for-dfn-package-33">MiniApp package</a> file is a container technology based on the [<cite><a class="bibref" data-link-type="biblio" href="#bib-zip" title=".ZIP File Format Specification">ZIP</a></cite>] archive format, including some modifications.</p> 

        <dl>
            <dt>Type name:</dt>
            <dd><code>application</code></dd>
            <dt>Subtype name:</dt>
            <dd><code>miniapp-pkg+zip</code></dd>
            <dt>Required parameters:</dt>
            <dd>"N/A"</dd>
            <dt>Optional parameters:</dt>
            <dd>"N/A"</dd>
            <dt>Encoding considerations:</dt>
            <dd>MiniApp packages are binary files encoded in the <a href="https://www.iana.org/assignments/media-types/application/zip">application/zip</a> media type. See <a href="https://datatracker.ietf.org/doc/html/rfc6839#section-3.6">RFC 6839, section 3.6</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6839" title="Additional Media Type Structured Syntax Suffixes">RFC6839</a></cite>].</dd>
            <dt>Security considerations:</dt>
            <dd>Security considerations that apply to application/zip also apply to MiniApp package files. User agents that process MiniApp package files should rigorously check the size and validity of data retrieved. When digital signatures are available in a MiniApp package file, the user agent <em class="rfc2119">SHOULD</em> implement necessary mechanisms to check the integrity and trustworthiness of the file according to the digital signatures, so as to to protect the end user and the hosting platform from the damage of package tampering or corruption. See more at <a href="#sec-security-privacy" class="sec-ref">§&nbsp;<bdi class="secno">6. </bdi>Security and Privacy Considerations</a>.</dd>
            <dt>Interoperability considerations:</dt>
            <dd>The file, after including the signature, is not a standard ZIP but the inclusion does not affect parsing and operation of the file as a ZIP file.</dd>
            <dt>Published specification:</dt>
            <dd>This media type registration is for the MiniApp package, as described in the specification located at <a href="https://www.w3.org/TR/miniapp-packaging/">https://www.w3.org/TR/miniapp-packaging/</a>.</dd>
            <dt>Applications that use this media type:</dt>
            <dd>This media type is used for the distribution of MiniApps. The list, non exhaustive, of applications and software platforms that (intend to) support this media type are:
            <ul>
                <li><a href="https://mp.360.cn/" hreflang="zh">360 Mini Programs</a></li>
                <li><a href="https://open.alipay.com/channel/miniIndex.htm" hreflang="zh">Alipay Mini Apps</a></li>
                <li><a href="https://smartprogram.baidu.com/developer/index.html" hreflang="zh">Baidu Smart Programs</a></li>
                <li><a href="https://www.quickapp.cn/" hreflang="zh">Quick Apps</a></li>
            </ul>
            <span class="note" title="To update the supporting applications">
                The listed applications above are the base technologies to develop this spec. They are not using the proposed media type yet, but will potentially support it when the spec is ready. The list shall be confirmed/updated later.
            </span>
            </dd>
            <dt>Fragment identifier considerations:</dt>
            <dd>"N/A"</dd>
            <dt>Additional information:</dt>
            <dd>
                <dl>
                    <dt>Deprecated alias names for this type:</dt>
                    <dd>"N/A"</dd>
                    <dt>Magic number(s):</dt>
                    <dd>50 4B 03 04</dd>
                    <dt>File extension(s):</dt>
                    <dd>MiniApps are usually identified with the extension <code>.ma</code>.</dd>
                    <dt>Macintosh file type code(s):</dt>
                    <dd>ZIP</dd>
                </dl>
            </dd>
            <dt>Person &amp; email address to contact for further information:</dt>
            <dd>The <a href="https://www.w3.org/2021/miniapps/" rel="nofollow">MiniApps Working Group</a> can be contacted at <a href="https://lists.w3.org/Archives/Public/public-miniapps-wg/" rel="nofollow">public-miniapps-wg@w3.org</a>.</dd>
            <dt>Intended usage:</dt>
            <dd>COMMON</dd>
            <dt>Restrictions on usage:</dt>
            <dd>"N/A"</dd>
            <dt>Author:</dt>
            <dd>The MiniApp Packaging defines a file format developed by the <abbr title="World Wide Web Consortium">W3C</abbr> MiniApp Working Group.</dd>
            <dt>Change controller:</dt>
            <dd><abbr title="World Wide Web Consortium">W3C</abbr> is the controller for the MiniApp Packaging specification</dd>
            <dt>Provisional registration?:</dt>
            <dd>"N/A"</dd>                      
        </dl>
        <div class="issue closed" id="issue-container-number-4"><div role="heading" class="issue-title marker" id="h-issue" aria-level="3"><a href="https://github.com/w3c/miniapp-packaging/issues/4"><span class="issue-number">Issue 4</span></a><span class="issue-label">: ZIP container for the package</span></div><div class="">This section needs to specify the technical details for the MIME type registration (like the extension).</div></div> 
        <div class="note" role="note" id="issue-container-generatedID-6"><div role="heading" class="note-title marker" id="h-note-2" aria-level="3"><span>Note</span></div><p class="">
            A temporary solution could be <code>application/x-w3c-miniapp-pkg+zip</code> for the sake of any early implementation.
        </p></div>

        <div class="issue" id="issue-container-generatedID-7"><div role="heading" class="issue-title marker" id="h-issue-0" aria-level="3"><span>Issue</span></div><p class="">Should processors check the integrity of the package (Security considerations section)?</p></div>

    </section>    




<section id="references" class="appendix"><h2 id="d-references"><bdi class="secno">D. </bdi>References<a class="self-link" aria-label="§" href="#references"></a></h2><section id="normative-references">
    <h3 id="d-1-normative-references"><bdi class="secno">D.1 </bdi>Normative references<a class="self-link" aria-label="§" href="#normative-references"></a></h3>
    <dl class="bibliography"><dt id="bib-bcp47">[BCP47]</dt><dd><a href="https://www.rfc-editor.org/rfc/rfc5646"><cite>Tags for Identifying Languages</cite></a>. A. Phillips, Ed.; M. Davis, Ed..  IETF. September 2009. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc5646">https://www.rfc-editor.org/rfc/rfc5646</a></dd><dt id="bib-css-snapshot">[CSS-SNAPSHOT]</dt><dd><a href="https://www.w3.org/TR/CSS/"><cite>CSS Snapshot</cite></a>. URL: <a href="https://www.w3.org/TR/CSS/">https://www.w3.org/TR/CSS/</a></dd><dt id="bib-ecma-262">[ECMA-262]</dt><dd><a href="https://tc39.es/ecma262/multipage/"><cite>ECMAScript Language Specification</cite></a>.  Ecma International. URL: <a href="https://tc39.es/ecma262/multipage/">https://tc39.es/ecma262/multipage/</a></dd><dt id="bib-fetch">[FETCH]</dt><dd><a href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. Anne van Kesteren.  WHATWG. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a></dd><dt id="bib-html">[HTML]</dt><dd><a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Anne van Kesteren; Domenic Denicola; Ian Hickson; Philip Jägenstedt; Simon Pieters.  WHATWG. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a></dd><dt id="bib-infra">[INFRA]</dt><dd><a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Anne van Kesteren; Domenic Denicola.  WHATWG. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a></dd><dt id="bib-json">[JSON]</dt><dd><a href="https://www.rfc-editor.org/rfc/rfc8259"><cite>The JavaScript Object Notation (JSON) Data Interchange Format</cite></a>. T. Bray, Ed..  IETF. December 2017. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc8259">https://www.rfc-editor.org/rfc/rfc8259</a></dd><dt id="bib-mimesniff">[MIMESNIFF]</dt><dd><a href="https://mimesniff.spec.whatwg.org/"><cite>MIME Sniffing Standard</cite></a>. Gordon P. Hemsley.  WHATWG. Living Standard. URL: <a href="https://mimesniff.spec.whatwg.org/">https://mimesniff.spec.whatwg.org/</a></dd><dt id="bib-miniapp-lifecycle">[MINIAPP-LIFECYCLE]</dt><dd><a href="https://www.w3.org/TR/miniapp-lifecycle/"><cite>MiniApp Lifecycle</cite></a>. Qing An; Haoyang Xu.  W3C. 29 October 2021. W3C Working Draft. URL: <a href="https://www.w3.org/TR/miniapp-lifecycle/">https://www.w3.org/TR/miniapp-lifecycle/</a></dd><dt id="bib-miniapp-manifest">[MINIAPP-MANIFEST]</dt><dd><a href="https://www.w3.org/TR/miniapp-manifest/"><cite>MiniApp Manifest</cite></a>. Martin Alvarez-Espinar; Yongjing ZHANG; Shouren Lan; Zhiqiang Yu; Xiaofeng Zhang.  W3C. 3 October 2021. W3C Working Draft. URL: <a href="https://www.w3.org/TR/miniapp-manifest/">https://www.w3.org/TR/miniapp-manifest/</a></dd><dt id="bib-rfc2119">[RFC2119]</dt><dd><a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a></dd><dt id="bib-rfc8174">[RFC8174]</dt><dd><a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a></dd><dt id="bib-uax15">[UAX15]</dt><dd><a href="https://www.unicode.org/reports/tr15/tr15-51.html"><cite>Unicode Normalization Forms</cite></a>. Ken Whistler.  Unicode Consortium. 27 August 2021. Unicode Standard Annex #15. URL: <a href="https://www.unicode.org/reports/tr15/tr15-51.html">https://www.unicode.org/reports/tr15/tr15-51.html</a></dd><dt id="bib-unicode">[Unicode]</dt><dd><a href="https://www.unicode.org/versions/latest/"><cite>The Unicode Standard</cite></a>.  Unicode Consortium. URL: <a href="https://www.unicode.org/versions/latest/">https://www.unicode.org/versions/latest/</a></dd><dt id="bib-url">[url]</dt><dd><a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Anne van Kesteren.  WHATWG. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a></dd><dt id="bib-zip">[ZIP]</dt><dd><a href="https://www.pkware.com/documents/casestudies/APPNOTE.TXT"><cite>.ZIP File Format Specification</cite></a>. 1 September 2012. Final. URL: <a href="https://www.pkware.com/documents/casestudies/APPNOTE.TXT">https://www.pkware.com/documents/casestudies/APPNOTE.TXT</a></dd></dl>
  </section><section id="informative-references">
    <h3 id="d-2-informative-references"><bdi class="secno">D.2 </bdi>Informative references<a class="self-link" aria-label="§" href="#informative-references"></a></h3>
    <dl class="bibliography"><dt id="bib-apk-signature-v2">[APK-SIGNATURE-V2]</dt><dd><a href="https://source.android.com/security/apksigning/v2"><cite>APK Signature Scheme v2</cite></a>. URL: <a href="https://source.android.com/security/apksigning/v2">https://source.android.com/security/apksigning/v2</a></dd><dt id="bib-charmod-norm">[CHARMOD-NORM]</dt><dd><a href="https://www.w3.org/TR/charmod-norm/"><cite>Character Model for the World Wide Web: String Matching</cite></a>. Addison Phillips et al.  W3C. 11 August 2021. W3C Working Group Note. URL: <a href="https://www.w3.org/TR/charmod-norm/">https://www.w3.org/TR/charmod-norm/</a></dd><dt id="bib-rfc1321">[rfc1321]</dt><dd><a href="https://www.rfc-editor.org/rfc/rfc1321"><cite>The MD5 Message-Digest Algorithm</cite></a>. R. Rivest.  IETF. April 1992. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc1321">https://www.rfc-editor.org/rfc/rfc1321</a></dd><dt id="bib-rfc2315">[rfc2315]</dt><dd><a href="https://www.rfc-editor.org/rfc/rfc2315"><cite>PKCS #7: Cryptographic Message Syntax Version 1.5</cite></a>. B. Kaliski.  IETF. March 1998. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc2315">https://www.rfc-editor.org/rfc/rfc2315</a></dd><dt id="bib-rfc2528">[rfc2528]</dt><dd><a href="https://www.rfc-editor.org/rfc/rfc2528"><cite>Internet X.509 Public Key Infrastructure Representation of Key Exchange Algorithm (KEA) Keys in Internet X.509 Public Key Infrastructure Certificates</cite></a>. R. Housley; W. Polk.  IETF. March 1999. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc2528">https://www.rfc-editor.org/rfc/rfc2528</a></dd><dt id="bib-rfc4289">[RFC4289]</dt><dd><a href="https://www.rfc-editor.org/rfc/rfc4289"><cite>Multipurpose Internet Mail Extensions (MIME) Part Four: Registration Procedures</cite></a>. N. Freed; J. Klensin.  IETF. December 2005. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc4289">https://www.rfc-editor.org/rfc/rfc4289</a></dd><dt id="bib-rfc6839">[RFC6839]</dt><dd><a href="https://www.rfc-editor.org/rfc/rfc6839"><cite>Additional Media Type Structured Syntax Suffixes</cite></a>. T. Hansen; A. Melnikov.  IETF. January 2013. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc6839">https://www.rfc-editor.org/rfc/rfc6839</a></dd><dt id="bib-x690">[X690]</dt><dd><a href="https://www.itu.int/ITU-T/studygroups/com17/languages/X.690-0207.pdf"><cite>Recommendation X.690 — Information Technology — ASN.1 Encoding Rules — Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER), and Distinguished Encoding Rules (DER)</cite></a>.  ITU. URL: <a href="https://www.itu.int/ITU-T/studygroups/com17/languages/X.690-0207.pdf">https://www.itu.int/ITU-T/studygroups/com17/languages/X.690-0207.pdf</a></dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-signature" aria-label="Links in this document to definition: Digital signature">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-signature" aria-label="Permalink for definition: Digital signature. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-signature-1" title="§ 1.1 Overview">§ 1.1 Overview</a> 
  </li><li>
    <a href="#ref-for-dfn-signature-2" title="§ 3.3 Digital Signature Requirements">§ 3.3 Digital Signature Requirements</a> 
  </li><li>
    <a href="#ref-for-dfn-signature-3" title="§ 6.1 Package Integrity and Trustworthiness">§ 6.1 Package Integrity and Trustworthiness</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-filename" aria-label="Links in this document to definition: File name">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-filename" aria-label="Permalink for definition: File name. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-filename-1" title="§ 2.1.5 File Names">§ 2.1.5 File Names</a> <a href="#ref-for-dfn-filename-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-filename-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-filename-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-filename-5" title="Reference 5">(5)</a> <a href="#ref-for-dfn-filename-6" title="Reference 6">(6)</a> <a href="#ref-for-dfn-filename-7" title="Reference 7">(7)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-miniapp" aria-label="Links in this document to definition: MiniApp">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-miniapp" aria-label="Permalink for definition: MiniApp. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-miniapp-1" title="§ 1.1 Overview">§ 1.1 Overview</a> 
  </li><li>
    <a href="#ref-for-dfn-miniapp-2" title="§ 5.4.1 Platform Compatibility Verification">§ 5.4.1 Platform Compatibility Verification</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-package" aria-label="Links in this document to definition: MiniApp package">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-package" aria-label="Permalink for definition: MiniApp package. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-package-1" title="§ Abstract">§ Abstract</a> <a href="#ref-for-dfn-package-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-package-3" title="§ 1.1 Overview">§ 1.1 Overview</a> <a href="#ref-for-dfn-package-4" title="Reference 2">(2)</a> <a href="#ref-for-dfn-package-5" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-package-6" title="§ 1.2 Terminology">§ 1.2 Terminology</a> <a href="#ref-for-dfn-package-7" title="Reference 2">(2)</a> <a href="#ref-for-dfn-package-8" title="Reference 3">(3)</a> <a href="#ref-for-dfn-package-9" title="Reference 4">(4)</a> <a href="#ref-for-dfn-package-10" title="Reference 5">(5)</a> 
  </li><li>
    <a href="#ref-for-dfn-package-11" title="§ 2. Package Conformance">§ 2. Package Conformance</a> <a href="#ref-for-dfn-package-12" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-package-13" title="§ 2.1 Directory and File System Structure">§ 2.1 Directory and File System Structure</a> 
  </li><li>
    <a href="#ref-for-dfn-package-14" title="§ 2.1.1 Root Directory">§ 2.1.1 Root Directory</a> <a href="#ref-for-dfn-package-15" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-package-16" title="§ 2.1.4 i18n Directory">§ 2.1.4 i18n Directory</a> 
  </li><li>
    <a href="#ref-for-dfn-package-17" title="§ 2.1.5 File Names">§ 2.1.5 File Names</a> <a href="#ref-for-dfn-package-18" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-package-19" title="§ 2.2.4 Localization Resources">§ 2.2.4 Localization Resources</a> 
  </li><li>
    <a href="#ref-for-dfn-package-20" title="§ 3.1 Introduction">§ 3.1 Introduction</a> 
  </li><li>
    <a href="#ref-for-dfn-package-21" title="§ 3.2 ZIP File Requirements">§ 3.2 ZIP File Requirements</a> 
  </li><li>
    <a href="#ref-for-dfn-package-22" title="§ 3.3 Digital Signature Requirements">§ 3.3 Digital Signature Requirements</a> 
  </li><li>
    <a href="#ref-for-dfn-package-23" title="§ 5. MiniApp Package Processing">§ 5. MiniApp Package Processing</a> 
  </li><li>
    <a href="#ref-for-dfn-package-24" title="§ 5.3 MiniApp Manifest Processing">§ 5.3 MiniApp Manifest Processing</a> <a href="#ref-for-dfn-package-25" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-package-26" title="§ 5.4.1 Platform Compatibility Verification">§ 5.4.1 Platform Compatibility Verification</a> 
  </li><li>
    <a href="#ref-for-dfn-package-27" title="§ 5.4.2 Start Page Identification">§ 5.4.2 Start Page Identification</a> 
  </li><li>
    <a href="#ref-for-dfn-package-28" title="§ 6.1 Package Integrity and Trustworthiness">§ 6.1 Package Integrity and Trustworthiness</a> <a href="#ref-for-dfn-package-29" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-package-30" title="§ 6.2 Content Confidentiality">§ 6.2 Content Confidentiality</a> 
  </li><li>
    <a href="#ref-for-dfn-package-31" title="§ B.1 RPK Signature Scheme">§ B.1 RPK Signature Scheme</a> 
  </li><li>
    <a href="#ref-for-dfn-package-32" title="§ B.1.1.1 Developer Signature">§ B.1.1.1 Developer Signature</a> 
  </li><li>
    <a href="#ref-for-dfn-package-33" title="§ C. Media Type Registration">§ C. Media Type Registration</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-resource" aria-label="Links in this document to definition: MiniApp resource">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-resource" aria-label="Permalink for definition: MiniApp resource. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-resource-1" title="§ 1.1 Overview">§ 1.1 Overview</a> 
  </li><li>
    <a href="#ref-for-dfn-resource-2" title="§ 1.2 Terminology">§ 1.2 Terminology</a> <a href="#ref-for-dfn-resource-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-resource-4" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-resource-5" title="§ 2.1.2 pages Directory">§ 2.1.2 pages Directory</a> <a href="#ref-for-dfn-resource-6" title="Reference 2">(2)</a> <a href="#ref-for-dfn-resource-7" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-resource-8" title="§ 2.1.3 common Directory">§ 2.1.3 common Directory</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-page" aria-label="Links in this document to definition: MiniApp page">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-page" aria-label="Permalink for definition: MiniApp page. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-page-1" title="§ 1.2 Terminology">§ 1.2 Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-page-2" title="§ 2.1.1 Root Directory">§ 2.1.1 Root Directory</a> 
  </li><li>
    <a href="#ref-for-dfn-page-3" title="§ 2.1.2 pages Directory">§ 2.1.2 pages Directory</a> <a href="#ref-for-dfn-page-4" title="Reference 2">(2)</a> <a href="#ref-for-dfn-page-5" title="Reference 3">(3)</a> <a href="#ref-for-dfn-page-6" title="Reference 4">(4)</a> <a href="#ref-for-dfn-page-7" title="Reference 5">(5)</a> <a href="#ref-for-dfn-page-8" title="Reference 6">(6)</a> 
  </li><li>
    <a href="#ref-for-dfn-page-9" title="§ 2.1.3 common Directory">§ 2.1.3 common Directory</a> 
  </li><li>
    <a href="#ref-for-dfn-page-10" title="§ 2.2 MiniApp Resources">§ 2.2 MiniApp Resources</a> <a href="#ref-for-dfn-page-11" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-page-12" title="§ 2.2.1 HTML Resources">§ 2.2.1 HTML Resources</a> <a href="#ref-for-dfn-page-13" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-page-14" title="§ 2.2.2 CSS Resources">§ 2.2.2 CSS Resources</a> <a href="#ref-for-dfn-page-15" title="Reference 2">(2)</a> <a href="#ref-for-dfn-page-16" title="Reference 3">(3)</a> <a href="#ref-for-dfn-page-17" title="Reference 4">(4)</a> <a href="#ref-for-dfn-page-18" title="Reference 5">(5)</a> 
  </li><li>
    <a href="#ref-for-dfn-page-19" title="§ 2.2.3 Scripting Resources">§ 2.2.3 Scripting Resources</a> <a href="#ref-for-dfn-page-20" title="Reference 2">(2)</a> <a href="#ref-for-dfn-page-21" title="Reference 3">(3)</a> <a href="#ref-for-dfn-page-22" title="Reference 4">(4)</a> <a href="#ref-for-dfn-page-23" title="Reference 5">(5)</a> 
  </li><li>
    <a href="#ref-for-dfn-page-24" title="§ 5.4.2 Start Page Identification">§ 5.4.2 Start Page Identification</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-useragent" aria-label="Links in this document to definition: MiniApp user agent">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-useragent" aria-label="Permalink for definition: MiniApp user agent. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-useragent-1" title="§ Abstract">§ Abstract</a> 
  </li><li>
    <a href="#ref-for-dfn-useragent-2" title="§ 1.1 Overview">§ 1.1 Overview</a> <a href="#ref-for-dfn-useragent-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-useragent-4" title="Reference 3">(3)</a> <a href="#ref-for-dfn-useragent-5" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-useragent-6" title="§ 1.2 Terminology">§ 1.2 Terminology</a> <a href="#ref-for-dfn-useragent-7" title="Reference 2">(2)</a> <a href="#ref-for-dfn-useragent-8" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-useragent-9" title="§ 2.2.4 Localization Resources">§ 2.2.4 Localization Resources</a> 
  </li><li>
    <a href="#ref-for-dfn-useragent-10" title="§ 3.2 ZIP File Requirements">§ 3.2 ZIP File Requirements</a> 
  </li><li>
    <a href="#ref-for-dfn-useragent-11" title="§ 4. Internationalization">§ 4. Internationalization</a> 
  </li><li>
    <a href="#ref-for-dfn-useragent-12" title="§ 5. MiniApp Package Processing">§ 5. MiniApp Package Processing</a> 
  </li><li>
    <a href="#ref-for-dfn-useragent-13" title="§ 5.1 MiniApp ZIP Container Retrieval">§ 5.1 MiniApp ZIP Container Retrieval</a> 
  </li><li>
    <a href="#ref-for-dfn-useragent-14" title="§ 5.2 MiniApp ZIP Container Verification">§ 5.2 MiniApp ZIP Container Verification</a> <a href="#ref-for-dfn-useragent-15" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-useragent-16" title="§ 5.2.1 Digital Signatures Processing">§ 5.2.1 Digital Signatures Processing</a> <a href="#ref-for-dfn-useragent-17" title="Reference 2">(2)</a> <a href="#ref-for-dfn-useragent-18" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-useragent-19" title="§ 5.3 MiniApp Manifest Processing">§ 5.3 MiniApp Manifest Processing</a> 
  </li><li>
    <a href="#ref-for-dfn-useragent-20" title="§ 5.4 Platform Runtime Preparation">§ 5.4 Platform Runtime Preparation</a> <a href="#ref-for-dfn-useragent-21" title="Reference 2">(2)</a> <a href="#ref-for-dfn-useragent-22" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-useragent-23" title="§ 5.4.1 Platform Compatibility Verification">§ 5.4.1 Platform Compatibility Verification</a> <a href="#ref-for-dfn-useragent-24" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-useragent-25" title="§ 5.4.2 Start Page Identification">§ 5.4.2 Start Page Identification</a> 
  </li><li>
    <a href="#ref-for-dfn-useragent-26" title="§ 5.4.3 Extraction of Locale">§ 5.4.3 Extraction of Locale</a> <a href="#ref-for-dfn-useragent-27" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-useragent-28" title="§ B. Signature Schemes">§ B. Signature Schemes</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-container" aria-label="Links in this document to definition: MiniApp ZIP container">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-container" aria-label="Permalink for definition: MiniApp ZIP container. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-container-1" title="§ 1.1 Overview">§ 1.1 Overview</a> 
  </li><li>
    <a href="#ref-for-dfn-container-2" title="§ 1.2 Terminology">§ 1.2 Terminology</a> <a href="#ref-for-dfn-container-3" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-container-4" title="§ 2. Package Conformance">§ 2. Package Conformance</a> 
  </li><li>
    <a href="#ref-for-dfn-container-5" title="§ 3.1 Introduction">§ 3.1 Introduction</a> <a href="#ref-for-dfn-container-6" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-container-7" title="§ 3.2 ZIP File Requirements">§ 3.2 ZIP File Requirements</a> <a href="#ref-for-dfn-container-8" title="Reference 2">(2)</a> <a href="#ref-for-dfn-container-9" title="Reference 3">(3)</a> <a href="#ref-for-dfn-container-10" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-container-11" title="§ 3.3 Digital Signature Requirements">§ 3.3 Digital Signature Requirements</a> <a href="#ref-for-dfn-container-12" title="Reference 2">(2)</a> <a href="#ref-for-dfn-container-13" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-container-14" title="§ 5.1 MiniApp ZIP Container Retrieval">§ 5.1 MiniApp ZIP Container Retrieval</a> <a href="#ref-for-dfn-container-15" title="Reference 2">(2)</a> <a href="#ref-for-dfn-container-16" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-container-17" title="§ 5.2 MiniApp ZIP Container Verification">§ 5.2 MiniApp ZIP Container Verification</a> <a href="#ref-for-dfn-container-18" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-container-19" title="§ 5.2.1 Digital Signatures Processing">§ 5.2.1 Digital Signatures Processing</a> <a href="#ref-for-dfn-container-20" title="Reference 2">(2)</a> <a href="#ref-for-dfn-container-21" title="Reference 3">(3)</a> <a href="#ref-for-dfn-container-22" title="Reference 4">(4)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-widget" aria-label="Links in this document to definition: MiniApp widget">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-widget" aria-label="Permalink for definition: MiniApp widget. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-start-page" aria-label="Links in this document to definition: MiniApp start page">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-start-page" aria-label="Permalink for definition: MiniApp start page. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-start-page-1" title="§ 1.1 Overview">§ 1.1 Overview</a> 
  </li><li>
    <a href="#ref-for-dfn-start-page-2" title="§ 5.4 Platform Runtime Preparation">§ 5.4 Platform Runtime Preparation</a> <a href="#ref-for-dfn-start-page-3" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-start-page-4" title="§ 5.4.2 Start Page Identification">§ 5.4.2 Start Page Identification</a> <a href="#ref-for-dfn-start-page-5" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-start-page-6" title="§ 5.4.2.1 Extraction of Start Page From URI">§ 5.4.2.1 Extraction of Start Page From URI</a> 
  </li><li>
    <a href="#ref-for-dfn-start-page-7" title="§ 5.4.2.2 Extraction of Start Page From Manifest">§ 5.4.2.2 Extraction of Start Page From Manifest</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-root-directory" aria-label="Links in this document to definition: MiniApp root directory">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-root-directory" aria-label="Permalink for definition: MiniApp root directory. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-root-directory-1" title="§ 2. Package Conformance">§ 2. Package Conformance</a> <a href="#ref-for-dfn-root-directory-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-root-directory-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-root-directory-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-root-directory-5" title="Reference 5">(5)</a> <a href="#ref-for-dfn-root-directory-6" title="Reference 6">(6)</a> 
  </li><li>
    <a href="#ref-for-dfn-root-directory-7" title="§ 2.1.1 Root Directory">§ 2.1.1 Root Directory</a> 
  </li><li>
    <a href="#ref-for-dfn-root-directory-8" title="§ 2.1.4 i18n Directory">§ 2.1.4 i18n Directory</a> 
  </li><li>
    <a href="#ref-for-dfn-root-directory-9" title="§ 2.2.2 CSS Resources">§ 2.2.2 CSS Resources</a> <a href="#ref-for-dfn-root-directory-10" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-root-directory-11" title="§ 2.2.3 Scripting Resources">§ 2.2.3 Scripting Resources</a> <a href="#ref-for-dfn-root-directory-12" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-root-directory-13" title="§ 5.3 MiniApp Manifest Processing">§ 5.3 MiniApp Manifest Processing</a> 
  </li><li>
    <a href="#ref-for-dfn-root-directory-14" title="§ 5.4 Platform Runtime Preparation">§ 5.4 Platform Runtime Preparation</a> <a href="#ref-for-dfn-root-directory-15" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-i18n-directory" aria-label="Links in this document to definition: i18n directory">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-i18n-directory" aria-label="Permalink for definition: i18n directory. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-i18n-directory-1" title="§ 2.1.4 i18n Directory">§ 2.1.4 i18n Directory</a> <a href="#ref-for-dfn-i18n-directory-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-i18n-directory-3" title="§ 4. Internationalization">§ 4. Internationalization</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-html-resource" aria-label="Links in this document to definition: HTML resources">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-html-resource" aria-label="Permalink for definition: HTML resources. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-html-resource-1" title="§ 2.2 MiniApp Resources">§ 2.2 MiniApp Resources</a> 
  </li><li>
    <a href="#ref-for-dfn-html-resource-2" title="§ 2.2.1 HTML Resources">§ 2.2.1 HTML Resources</a> <a href="#ref-for-dfn-html-resource-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-html-resource-4" title="Reference 3">(3)</a> <a href="#ref-for-dfn-html-resource-5" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-html-resource-6" title="§ 2.2.2 CSS Resources">§ 2.2.2 CSS Resources</a> 
  </li><li>
    <a href="#ref-for-dfn-html-resource-7" title="§ 2.2.3 Scripting Resources">§ 2.2.3 Scripting Resources</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-css-resource" aria-label="Links in this document to definition: CSS resources">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-css-resource" aria-label="Permalink for definition: CSS resources. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-css-resource-1" title="§ 2.2 MiniApp Resources">§ 2.2 MiniApp Resources</a> 
  </li><li>
    <a href="#ref-for-dfn-css-resource-2" title="§ 2.2.1 HTML Resources">§ 2.2.1 HTML Resources</a> 
  </li><li>
    <a href="#ref-for-dfn-css-resource-3" title="§ 2.2.2 CSS Resources">§ 2.2.2 CSS Resources</a> <a href="#ref-for-dfn-css-resource-4" title="Reference 2">(2)</a> <a href="#ref-for-dfn-css-resource-5" title="Reference 3">(3)</a> <a href="#ref-for-dfn-css-resource-6" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-css-resource-7" title="§ 2.2.3 Scripting Resources">§ 2.2.3 Scripting Resources</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-js-resource" aria-label="Links in this document to definition: Scripting resources">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-js-resource" aria-label="Permalink for definition: Scripting resources. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-js-resource-1" title="§ 2.2 MiniApp Resources">§ 2.2 MiniApp Resources</a> 
  </li><li>
    <a href="#ref-for-dfn-js-resource-2" title="§ 2.2.1 HTML Resources">§ 2.2.1 HTML Resources</a> 
  </li><li>
    <a href="#ref-for-dfn-js-resource-3" title="§ 2.2.2 CSS Resources">§ 2.2.2 CSS Resources</a> 
  </li><li>
    <a href="#ref-for-dfn-js-resource-4" title="§ 2.2.3 Scripting Resources">§ 2.2.3 Scripting Resources</a> <a href="#ref-for-dfn-js-resource-5" title="Reference 2">(2)</a> <a href="#ref-for-dfn-js-resource-6" title="Reference 3">(3)</a> <a href="#ref-for-dfn-js-resource-7" title="Reference 4">(4)</a> <a href="#ref-for-dfn-js-resource-8" title="Reference 5">(5)</a> <a href="#ref-for-dfn-js-resource-9" title="Reference 6">(6)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-localization-resources" aria-label="Links in this document to definition: MiniApp localization resource">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-localization-resources" aria-label="Permalink for definition: MiniApp localization resource. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-localization-resources-1" title="§ 2. Package Conformance">§ 2. Package Conformance</a> 
  </li><li>
    <a href="#ref-for-dfn-localization-resources-2" title="§ 2.1.4 i18n Directory">§ 2.1.4 i18n Directory</a> <a href="#ref-for-dfn-localization-resources-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-localization-resources-4" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-localization-resources-5" title="§ 2.2.4 Localization Resources">§ 2.2.4 Localization Resources</a> <a href="#ref-for-dfn-localization-resources-6" title="Reference 2">(2)</a> <a href="#ref-for-dfn-localization-resources-7" title="Reference 3">(3)</a> <a href="#ref-for-dfn-localization-resources-8" title="Reference 4">(4)</a> <a href="#ref-for-dfn-localization-resources-9" title="Reference 5">(5)</a> 
  </li><li>
    <a href="#ref-for-dfn-localization-resources-10" title="§ 4. Internationalization">§ 4. Internationalization</a> <a href="#ref-for-dfn-localization-resources-11" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-signing_block" aria-label="Links in this document to definition: MiniApp signing block">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-signing_block" aria-label="Permalink for definition: MiniApp signing block. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-signing_block-1" title="§ 3.2 ZIP File Requirements">§ 3.2 ZIP File Requirements</a> <a href="#ref-for-dfn-signing_block-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-signing_block-3" title="§ 3.3 Digital Signature Requirements">§ 3.3 Digital Signature Requirements</a> <a href="#ref-for-dfn-signing_block-4" title="Reference 2">(2)</a> <a href="#ref-for-dfn-signing_block-5" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-signing_block-6" title="§ 5.2.1 Digital Signatures Processing">§ 5.2.1 Digital Signatures Processing</a> <a href="#ref-for-dfn-signing_block-7" title="Reference 2">(2)</a> <a href="#ref-for-dfn-signing_block-8" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-signing_block-9" title="§ B.1 RPK Signature Scheme">§ B.1 RPK Signature Scheme</a> <a href="#ref-for-dfn-signing_block-10" title="Reference 2">(2)</a> <a href="#ref-for-dfn-signing_block-11" title="Reference 3">(3)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-magic-numbers" aria-label="Links in this document to definition: signing block magic numbers">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-magic-numbers" aria-label="Permalink for definition: signing block magic numbers. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-magic-numbers-1" title="§ 3.2 ZIP File Requirements">§ 3.2 ZIP File Requirements</a> 
  </li><li>
    <a href="#ref-for-dfn-magic-numbers-2" title="§ 3.3 Digital Signature Requirements">§ 3.3 Digital Signature Requirements</a> 
  </li><li>
    <a href="#ref-for-dfn-magic-numbers-3" title="§ 5.2.1 Digital Signatures Processing">§ 5.2.1 Digital Signatures Processing</a> <a href="#ref-for-dfn-magic-numbers-4" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-i18n" aria-label="Links in this document to definition: Internationalization">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-i18n" aria-label="Permalink for definition: Internationalization. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-i18n-1" title="§ 2.2.4 Localization Resources">§ 2.2.4 Localization Resources</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-localization" aria-label="Links in this document to definition: Localization">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-localization" aria-label="Permalink for definition: Localization. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-localization-1" title="§ 2.2.4 Localization Resources">§ 2.2.4 Localization Resources</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-process-a-miniapp-package" aria-label="Links in this document to definition: process a MiniApp package">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-process-a-miniapp-package" aria-label="Permalink for definition: process a MiniApp package. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-retrieving-a-miniapp-zip-container" aria-label="Links in this document to definition: retrieve a MiniApp ZIP container">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-retrieving-a-miniapp-zip-container" aria-label="Permalink for definition: retrieve a MiniApp ZIP container. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-retrieving-a-miniapp-zip-container-1" title="§ 5. MiniApp Package Processing">§ 5. MiniApp Package Processing</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-verifying-a-miniapp-zip-container" aria-label="Links in this document to definition: verify a MiniApp ZIP container">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-verifying-a-miniapp-zip-container" aria-label="Permalink for definition: verify a MiniApp ZIP container. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-verifying-a-miniapp-zip-container-1" title="§ 5. MiniApp Package Processing">§ 5. MiniApp Package Processing</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-processing-the-digital-signatures" aria-label="Links in this document to definition: process the digital signatures">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-processing-the-digital-signatures" aria-label="Permalink for definition: process the digital signatures. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-processing-the-digital-signatures-1" title="§ 3.2 ZIP File Requirements">§ 3.2 ZIP File Requirements</a> 
  </li><li>
    <a href="#ref-for-dfn-processing-the-digital-signatures-2" title="§ 5.2 MiniApp ZIP Container Verification">§ 5.2 MiniApp ZIP Container Verification</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-processing-the-miniapp-manifest" aria-label="Links in this document to definition: process the MiniApp manifest">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-processing-the-miniapp-manifest" aria-label="Permalink for definition: process the MiniApp manifest. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-processing-the-miniapp-manifest-1" title="§ 5. MiniApp Package Processing">§ 5. MiniApp Package Processing</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-preparing-the-platform-runtime" aria-label="Links in this document to definition: prepare the platform runtime">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-preparing-the-platform-runtime" aria-label="Permalink for definition: prepare the platform runtime. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-preparing-the-platform-runtime-1" title="§ 5. MiniApp Package Processing">§ 5. MiniApp Package Processing</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-verify-platform-compatibility" aria-label="Links in this document to definition: verify platform compatibility">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-verify-platform-compatibility" aria-label="Permalink for definition: verify platform compatibility. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-verify-platform-compatibility-1" title="§ 5.4 Platform Runtime Preparation">§ 5.4 Platform Runtime Preparation</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-determining-the-start-page" aria-label="Links in this document to definition: determine the start page">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-determining-the-start-page" aria-label="Permalink for definition: determine the start page. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-determining-the-start-page-1" title="§ 5.4 Platform Runtime Preparation">§ 5.4 Platform Runtime Preparation</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-extracting-the-start-page-from-uri" aria-label="Links in this document to definition: extract the start page from URI">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-extracting-the-start-page-from-uri" aria-label="Permalink for definition: extract the start page from URI. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-extracting-the-start-page-from-uri-1" title="§ 5.4.2 Start Page Identification">§ 5.4.2 Start Page Identification</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-extracting-the-start-page-from-manifest" aria-label="Links in this document to definition: extract the start page from manifest">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-extracting-the-start-page-from-manifest" aria-label="Permalink for definition: extract the start page from manifest. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-extracting-the-start-page-from-manifest-1" title="§ 5.4.2 Start Page Identification">§ 5.4.2 Start Page Identification</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-extracting-the-locale" aria-label="Links in this document to definition: extract the locale">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-extracting-the-locale" aria-label="Permalink for definition: extract the locale. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-extracting-the-locale-1" title="§ 5. MiniApp Package Processing">§ 5. MiniApp Package Processing</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-provisioning-profile" aria-label="Links in this document to definition: provisioning profile">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-provisioning-profile" aria-label="Permalink for definition: provisioning profile. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-provisioning-profile-1" title="§ B.1.1.2 Distributor Signature">§ B.1.1.2 Distributor Signature</a> <a href="#ref-for-dfn-provisioning-profile-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-provisioning-profile-3" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-provisioning-profile-4" title="§ B.2 PKCS#7 Signature Scheme">§ B.2 PKCS#7 Signature Scheme</a> <a href="#ref-for-dfn-provisioning-profile-5" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>